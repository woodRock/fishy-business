2024-11-01 21:05:05,308 - INFO - Starting training pipeline
2024-11-01 21:05:05,309 - INFO - Creating DataModule with augmentation parameters: {'num_augmentations': 5, 'noise_level': 0.1, 'shift_enabled': False, 'scale_enabled': False}
2024-11-01 21:05:05,309 - INFO - Created augmentation config with 5 augmentations
2024-11-01 21:05:05,309 - INFO - Loading dataset: species
2024-11-01 21:05:05,309 - INFO - Loading data from: /vol/ecrg-solar/woodj4/fishy-business/data/REIMS.xlsx
2024-11-01 21:05:14,974 - INFO - Loaded data with shape: (306, 2081)
2024-11-01 21:05:14,979 - INFO - Filtered data shape: (108, 2081)
2024-11-01 21:05:14,979 - INFO - Dataset shape after filtering: (108, 2081)
2024-11-01 21:05:14,981 - INFO - Features shape: (108, 2080), Labels shape: (108, 2)
2024-11-01 21:05:14,985 - INFO - Main training dataset size: 108 samples
2024-11-01 21:05:14,986 - INFO - Creating DataModule with augmentation parameters: {'num_augmentations': 5, 'noise_level': 0.1, 'shift_enabled': False, 'scale_enabled': False}
2024-11-01 21:05:14,986 - INFO - Created augmentation config with 5 augmentations
2024-11-01 21:05:14,986 - INFO - Loading dataset: species
2024-11-01 21:05:14,986 - INFO - Loading data from: /vol/ecrg-solar/woodj4/fishy-business/data/REIMS.xlsx
2024-11-01 21:05:24,330 - INFO - Loaded data with shape: (306, 2081)
2024-11-01 21:05:24,330 - INFO - Dataset shape after filtering: (306, 2081)
2024-11-01 21:05:24,334 - INFO - Features shape: (306, 2080), Labels shape: (306, 2)
2024-11-01 21:05:24,336 - INFO - Pre-training dataset size: 306 samples
2024-11-01 21:05:24,336 - INFO - Starting pre-training phase
2024-11-01 21:05:24,336 - INFO - Loading dataset: species
2024-11-01 21:05:24,336 - INFO - Loading data from: /vol/ecrg-solar/woodj4/fishy-business/data/REIMS.xlsx
2024-11-01 21:05:33,436 - INFO - Loaded data with shape: (306, 2081)
2024-11-01 21:05:33,437 - INFO - Dataset shape after filtering: (306, 2081)
2024-11-01 21:05:33,441 - INFO - Features shape: (306, 2080), Labels shape: (306, 2)
2024-11-01 21:05:34,496 - INFO - Created model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=2080, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=2080, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=2080, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=2080, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=2080, out_features=2080, bias=True)
)
2024-11-01 21:05:35,417 - INFO - Starting Masked Spectra Modelling
2024-11-01 21:06:57,372 - INFO - Epoch [1/100], Loss: 0.0050
2024-11-01 21:08:20,780 - INFO - Epoch [2/100], Loss: 0.0036
