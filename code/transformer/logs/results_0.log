INFO:__main__:Reading the dataset: fish cross-species
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-2): 3 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-2): 3 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=3, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100, Train Loss: 1.2110, Train Acc: 0.3033, Val Loss: 1.0414, Val Acc: 0.4839
INFO:train:Epoch 2/100, Train Loss: 0.9569, Train Acc: 0.5984, Val Loss: 0.9104, Val Acc: 0.6129
INFO:train:Epoch 3/100, Train Loss: 0.8030, Train Acc: 0.6967, Val Loss: 0.8199, Val Acc: 0.6452
INFO:train:Epoch 4/100, Train Loss: 0.6733, Train Acc: 0.7951, Val Loss: 0.7756, Val Acc: 0.7097
INFO:train:Epoch 5/100, Train Loss: 0.6246, Train Acc: 0.8607, Val Loss: 0.7571, Val Acc: 0.7097
INFO:train:Epoch 6/100, Train Loss: 0.5715, Train Acc: 0.8770, Val Loss: 0.7478, Val Acc: 0.6774
INFO:train:Epoch 7/100, Train Loss: 0.5278, Train Acc: 0.9262, Val Loss: 0.7503, Val Acc: 0.6452
INFO:train:Epoch 8/100, Train Loss: 0.4954, Train Acc: 0.9344, Val Loss: 0.7575, Val Acc: 0.6452
INFO:train:Epoch 9/100, Train Loss: 0.4849, Train Acc: 0.9180, Val Loss: 0.7559, Val Acc: 0.6452
INFO:train:Epoch 10/100, Train Loss: 0.4505, Train Acc: 0.9426, Val Loss: 0.7368, Val Acc: 0.7419
INFO:train:Epoch 11/100, Train Loss: 0.4433, Train Acc: 0.9344, Val Loss: 0.7166, Val Acc: 0.7419
INFO:train:Epoch 12/100, Train Loss: 0.4155, Train Acc: 0.9590, Val Loss: 0.7113, Val Acc: 0.7419
INFO:train:Epoch 13/100, Train Loss: 0.4128, Train Acc: 0.9836, Val Loss: 0.7072, Val Acc: 0.7419
INFO:train:Epoch 14/100, Train Loss: 0.4061, Train Acc: 0.9672, Val Loss: 0.7100, Val Acc: 0.7419
INFO:train:Epoch 15/100, Train Loss: 0.4003, Train Acc: 0.9590, Val Loss: 0.7236, Val Acc: 0.7419
INFO:train:Epoch 16/100, Train Loss: 0.3902, Train Acc: 0.9508, Val Loss: 0.7116, Val Acc: 0.7419
INFO:train:Epoch 17/100, Train Loss: 0.3886, Train Acc: 0.9836, Val Loss: 0.6869, Val Acc: 0.7419
INFO:train:Epoch 18/100, Train Loss: 0.3757, Train Acc: 0.9836, Val Loss: 0.6612, Val Acc: 0.7419
INFO:train:Epoch 19/100, Train Loss: 0.3588, Train Acc: 1.0000, Val Loss: 0.6540, Val Acc: 0.7419
INFO:train:Epoch 20/100, Train Loss: 0.3495, Train Acc: 1.0000, Val Loss: 0.6548, Val Acc: 0.7419
INFO:train:Epoch 21/100, Train Loss: 0.3393, Train Acc: 1.0000, Val Loss: 0.6593, Val Acc: 0.7419
INFO:train:Epoch 22/100, Train Loss: 0.3469, Train Acc: 0.9918, Val Loss: 0.6684, Val Acc: 0.7419
INFO:train:Epoch 23/100, Train Loss: 0.3339, Train Acc: 1.0000, Val Loss: 0.6587, Val Acc: 0.7419
INFO:train:Epoch 24/100, Train Loss: 0.3369, Train Acc: 1.0000, Val Loss: 0.6440, Val Acc: 0.7419
INFO:train:Epoch 25/100, Train Loss: 0.3345, Train Acc: 1.0000, Val Loss: 0.6415, Val Acc: 0.7419
INFO:train:Epoch 26/100, Train Loss: 0.3284, Train Acc: 1.0000, Val Loss: 0.6442, Val Acc: 0.7419
INFO:train:Epoch 27/100, Train Loss: 0.3241, Train Acc: 1.0000, Val Loss: 0.6483, Val Acc: 0.7419
INFO:train:Epoch 28/100, Train Loss: 0.3253, Train Acc: 1.0000, Val Loss: 0.6616, Val Acc: 0.7742
INFO:train:Epoch 29/100, Train Loss: 0.3321, Train Acc: 1.0000, Val Loss: 0.6719, Val Acc: 0.7742
INFO:train:Epoch 30/100, Train Loss: 0.3276, Train Acc: 1.0000, Val Loss: 0.6707, Val Acc: 0.7742
INFO:train:Epoch 31/100, Train Loss: 0.3241, Train Acc: 1.0000, Val Loss: 0.6584, Val Acc: 0.7742
INFO:train:Epoch 32/100, Train Loss: 0.3192, Train Acc: 1.0000, Val Loss: 0.6405, Val Acc: 0.7742
INFO:train:Epoch 33/100, Train Loss: 0.3172, Train Acc: 1.0000, Val Loss: 0.6357, Val Acc: 0.7742
INFO:train:Epoch 34/100, Train Loss: 0.3195, Train Acc: 1.0000, Val Loss: 0.6399, Val Acc: 0.7742
INFO:train:Epoch 35/100, Train Loss: 0.3153, Train Acc: 1.0000, Val Loss: 0.6470, Val Acc: 0.7742
INFO:train:Epoch 36/100, Train Loss: 0.3127, Train Acc: 1.0000, Val Loss: 0.6615, Val Acc: 0.7419
INFO:train:Epoch 37/100, Train Loss: 0.3159, Train Acc: 1.0000, Val Loss: 0.6646, Val Acc: 0.7419
INFO:train:Epoch 38/100, Train Loss: 0.3138, Train Acc: 1.0000, Val Loss: 0.6606, Val Acc: 0.7419
INFO:train:Epoch 39/100, Train Loss: 0.3107, Train Acc: 1.0000, Val Loss: 0.6577, Val Acc: 0.7419
INFO:train:Epoch 40/100, Train Loss: 0.3117, Train Acc: 1.0000, Val Loss: 0.6561, Val Acc: 0.7419
INFO:train:Epoch 41/100, Train Loss: 0.3131, Train Acc: 1.0000, Val Loss: 0.6608, Val Acc: 0.7419
INFO:train:Epoch 42/100, Train Loss: 0.3107, Train Acc: 1.0000, Val Loss: 0.6668, Val Acc: 0.7419
INFO:train:Early stopping
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 14.60s
INFO:__main__:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:__main__:train got 58 / 58 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:__main__:validation got 24 / 31 correct, accuracy: 0.7741935483870968
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:plot:Saving attention map to: figures/encoder_attention_map.png
INFO:plot:Saving attention map to: figures/decoder_attention_map.png
