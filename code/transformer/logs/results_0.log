INFO:__main__:Reading the dataset: fish species
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=2, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 0.7342, Train Acc: 0.5349	 Val Loss: 0.5160, Val Acc: 0.7727
INFO:train:Epoch 2/100 	Train Loss: 0.4198, Train Acc: 0.8953	 Val Loss: 0.4109, Val Acc: 0.8636
INFO:train:Epoch 3/100 	Train Loss: 0.3118, Train Acc: 0.9535	 Val Loss: 0.3526, Val Acc: 0.8636
INFO:train:Epoch 4/100 	Train Loss: 0.2588, Train Acc: 0.9884	 Val Loss: 0.2947, Val Acc: 0.9091
INFO:train:Epoch 5/100 	Train Loss: 0.2404, Train Acc: 0.9884	 Val Loss: 0.2764, Val Acc: 0.9545
INFO:train:Epoch 6/100 	Train Loss: 0.2457, Train Acc: 0.9884	 Val Loss: 0.2607, Val Acc: 1.0000
INFO:train:Epoch 7/100 	Train Loss: 0.2535, Train Acc: 1.0000	 Val Loss: 0.2634, Val Acc: 1.0000
INFO:train:Epoch 8/100 	Train Loss: 0.2486, Train Acc: 0.9884	 Val Loss: 0.2623, Val Acc: 1.0000
INFO:train:Epoch 9/100 	Train Loss: 0.2426, Train Acc: 1.0000	 Val Loss: 0.2602, Val Acc: 1.0000
INFO:train:Epoch 10/100 	Train Loss: 0.2369, Train Acc: 1.0000	 Val Loss: 0.2575, Val Acc: 1.0000
INFO:train:Epoch 11/100 	Train Loss: 0.2355, Train Acc: 1.0000	 Val Loss: 0.2526, Val Acc: 1.0000
INFO:train:Epoch 12/100 	Train Loss: 0.2316, Train Acc: 1.0000	 Val Loss: 0.2475, Val Acc: 1.0000
INFO:train:Epoch 13/100 	Train Loss: 0.2299, Train Acc: 1.0000	 Val Loss: 0.2438, Val Acc: 1.0000
INFO:train:Epoch 14/100 	Train Loss: 0.2279, Train Acc: 1.0000	 Val Loss: 0.2409, Val Acc: 1.0000
INFO:train:Epoch 15/100 	Train Loss: 0.2222, Train Acc: 1.0000	 Val Loss: 0.2369, Val Acc: 1.0000
INFO:train:Epoch 16/100 	Train Loss: 0.2209, Train Acc: 1.0000	 Val Loss: 0.2347, Val Acc: 1.0000
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 0.2118, Train Acc: 1.0000	 Val Loss: 0.2326, Val Acc: 1.0000
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 0.2220, Train Acc: 1.0000	 Val Loss: 0.2304, Val Acc: 1.0000
INFO:train:Early stopping triggered after 18 epochs
INFO:train:Epoch 19/100 	Train Loss: 0.2165, Train Acc: 1.0000	 Val Loss: 0.2292, Val Acc: 1.0000
INFO:train:Early stopping triggered after 19 epochs
INFO:train:Epoch 20/100 	Train Loss: 0.2134, Train Acc: 1.0000	 Val Loss: 0.2294, Val Acc: 1.0000
INFO:train:Early stopping triggered after 20 epochs
INFO:train:Epoch 21/100 	Train Loss: 0.2135, Train Acc: 1.0000	 Val Loss: 0.2295, Val Acc: 1.0000
INFO:train:Early stopping triggered after 21 epochs
INFO:train:Epoch 22/100 	Train Loss: 0.2125, Train Acc: 1.0000	 Val Loss: 0.2290, Val Acc: 1.0000
INFO:train:Early stopping triggered after 22 epochs
INFO:train:Epoch 23/100 	Train Loss: 0.2132, Train Acc: 1.0000	 Val Loss: 0.2281, Val Acc: 1.0000
INFO:train:Early stopping triggered after 23 epochs
INFO:train:Epoch 24/100 	Train Loss: 0.2113, Train Acc: 1.0000	 Val Loss: 0.2277, Val Acc: 1.0000
INFO:train:Early stopping triggered after 24 epochs
INFO:train:Epoch 25/100 	Train Loss: 0.2101, Train Acc: 1.0000	 Val Loss: 0.2316, Val Acc: 1.0000
INFO:train:Early stopping triggered after 25 epochs
INFO:train:Epoch 26/100 	Train Loss: 0.2098, Train Acc: 1.0000	 Val Loss: 0.2323, Val Acc: 1.0000
INFO:train:Early stopping triggered after 26 epochs
INFO:train:Epoch 27/100 	Train Loss: 0.2116, Train Acc: 1.0000	 Val Loss: 0.2390, Val Acc: 1.0000
INFO:train:Early stopping triggered after 27 epochs
INFO:train:Epoch 28/100 	Train Loss: 0.2097, Train Acc: 1.0000	 Val Loss: 0.2357, Val Acc: 1.0000
INFO:train:Early stopping triggered after 28 epochs
INFO:train:Epoch 29/100 	Train Loss: 0.2096, Train Acc: 1.0000	 Val Loss: 0.2327, Val Acc: 1.0000
INFO:train:Early stopping triggered after 29 epochs
INFO:train:Epoch 30/100 	Train Loss: 0.2088, Train Acc: 1.0000	 Val Loss: 0.2292, Val Acc: 1.0000
INFO:train:Early stopping triggered after 30 epochs
INFO:train:Epoch 31/100 	Train Loss: 0.2090, Train Acc: 1.0000	 Val Loss: 0.2314, Val Acc: 1.0000
INFO:train:Early stopping triggered after 31 epochs
INFO:train:Epoch 32/100 	Train Loss: 0.2078, Train Acc: 1.0000	 Val Loss: 0.2290, Val Acc: 1.0000
INFO:train:Early stopping triggered after 32 epochs
INFO:train:Epoch 33/100 	Train Loss: 0.2077, Train Acc: 1.0000	 Val Loss: 0.2339, Val Acc: 1.0000
INFO:train:Early stopping triggered after 33 epochs
INFO:train:Epoch 34/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2299, Val Acc: 1.0000
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2343, Val Acc: 1.0000
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 0.2053, Train Acc: 1.0000	 Val Loss: 0.2308, Val Acc: 1.0000
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 0.2078, Train Acc: 1.0000	 Val Loss: 0.2313, Val Acc: 1.0000
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2325, Val Acc: 1.0000
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 0.2063, Train Acc: 1.0000	 Val Loss: 0.2349, Val Acc: 1.0000
INFO:train:Early stopping triggered after 39 epochs
INFO:train:Epoch 40/100 	Train Loss: 0.2077, Train Acc: 1.0000	 Val Loss: 0.2332, Val Acc: 1.0000
INFO:train:Early stopping triggered after 40 epochs
INFO:train:Epoch 41/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2348, Val Acc: 1.0000
INFO:train:Early stopping triggered after 41 epochs
INFO:train:Epoch 42/100 	Train Loss: 0.2050, Train Acc: 1.0000	 Val Loss: 0.2335, Val Acc: 1.0000
INFO:train:Early stopping triggered after 42 epochs
INFO:train:Epoch 43/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2344, Val Acc: 1.0000
INFO:train:Early stopping triggered after 43 epochs
INFO:train:Epoch 44/100 	Train Loss: 0.2077, Train Acc: 1.0000	 Val Loss: 0.2353, Val Acc: 1.0000
INFO:train:Early stopping triggered after 44 epochs
INFO:train:Epoch 45/100 	Train Loss: 0.2055, Train Acc: 1.0000	 Val Loss: 0.2338, Val Acc: 1.0000
INFO:train:Early stopping triggered after 45 epochs
INFO:train:Epoch 46/100 	Train Loss: 0.2089, Train Acc: 1.0000	 Val Loss: 0.2279, Val Acc: 1.0000
INFO:train:Early stopping triggered after 46 epochs
INFO:train:Epoch 47/100 	Train Loss: 0.2076, Train Acc: 1.0000	 Val Loss: 0.2264, Val Acc: 1.0000
INFO:train:Early stopping triggered after 47 epochs
INFO:train:Epoch 48/100 	Train Loss: 0.2063, Train Acc: 1.0000	 Val Loss: 0.2259, Val Acc: 1.0000
INFO:train:Early stopping triggered after 48 epochs
INFO:train:Epoch 49/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2280, Val Acc: 1.0000
INFO:train:Early stopping triggered after 49 epochs
INFO:train:Epoch 50/100 	Train Loss: 0.2047, Train Acc: 1.0000	 Val Loss: 0.2291, Val Acc: 1.0000
INFO:train:Early stopping triggered after 50 epochs
INFO:train:Epoch 51/100 	Train Loss: 0.2070, Train Acc: 1.0000	 Val Loss: 0.2320, Val Acc: 1.0000
INFO:train:Early stopping triggered after 51 epochs
INFO:train:Epoch 52/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2291, Val Acc: 1.0000
INFO:train:Early stopping triggered after 52 epochs
INFO:train:Epoch 53/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2296, Val Acc: 1.0000
INFO:train:Early stopping triggered after 53 epochs
INFO:train:Epoch 54/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2355, Val Acc: 1.0000
INFO:train:Early stopping triggered after 54 epochs
INFO:train:Epoch 55/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2413, Val Acc: 0.9545
INFO:train:Early stopping triggered after 55 epochs
INFO:train:Epoch 56/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2357, Val Acc: 1.0000
INFO:train:Early stopping triggered after 56 epochs
INFO:train:Epoch 57/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2336, Val Acc: 1.0000
INFO:train:Early stopping triggered after 57 epochs
INFO:train:Epoch 58/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2307, Val Acc: 1.0000
INFO:train:Early stopping triggered after 58 epochs
INFO:train:Epoch 59/100 	Train Loss: 0.2057, Train Acc: 1.0000	 Val Loss: 0.2338, Val Acc: 1.0000
INFO:train:Early stopping triggered after 59 epochs
INFO:train:Epoch 60/100 	Train Loss: 0.2055, Train Acc: 1.0000	 Val Loss: 0.2310, Val Acc: 1.0000
INFO:train:Early stopping triggered after 60 epochs
INFO:train:Epoch 61/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2330, Val Acc: 1.0000
INFO:train:Early stopping triggered after 61 epochs
INFO:train:Epoch 62/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2377, Val Acc: 1.0000
INFO:train:Early stopping triggered after 62 epochs
INFO:train:Epoch 63/100 	Train Loss: 0.2063, Train Acc: 1.0000	 Val Loss: 0.2343, Val Acc: 1.0000
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2383, Val Acc: 0.9545
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.2078, Train Acc: 1.0000	 Val Loss: 0.2306, Val Acc: 1.0000
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.2054, Train Acc: 1.0000	 Val Loss: 0.2303, Val Acc: 1.0000
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.2038, Train Acc: 1.0000	 Val Loss: 0.2360, Val Acc: 1.0000
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.2050, Train Acc: 1.0000	 Val Loss: 0.2362, Val Acc: 1.0000
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2350, Val Acc: 1.0000
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2334, Val Acc: 1.0000
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.2042, Train Acc: 1.0000	 Val Loss: 0.2292, Val Acc: 1.0000
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2279, Val Acc: 1.0000
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.2043, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2250, Val Acc: 1.0000
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2244, Val Acc: 1.0000
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.2050, Train Acc: 1.0000	 Val Loss: 0.2243, Val Acc: 1.0000
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.2043, Train Acc: 1.0000	 Val Loss: 0.2237, Val Acc: 1.0000
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2238, Val Acc: 1.0000
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2228, Val Acc: 1.0000
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2262, Val Acc: 1.0000
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2241, Val Acc: 1.0000
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.2054, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.2086, Train Acc: 1.0000	 Val Loss: 0.2262, Val Acc: 1.0000
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.2043, Train Acc: 1.0000	 Val Loss: 0.2262, Val Acc: 1.0000
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2272, Val Acc: 1.0000
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2283, Val Acc: 1.0000
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2258, Val Acc: 1.0000
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.2053, Train Acc: 1.0000	 Val Loss: 0.2272, Val Acc: 1.0000
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2275, Val Acc: 1.0000
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.2055, Train Acc: 1.0000	 Val Loss: 0.2290, Val Acc: 1.0000
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.2040, Train Acc: 1.0000	 Val Loss: 0.2343, Val Acc: 1.0000
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2338, Val Acc: 1.0000
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2316, Val Acc: 1.0000
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.2057, Train Acc: 1.0000	 Val Loss: 0.2295, Val Acc: 1.0000
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.2076, Train Acc: 1.0000	 Val Loss: 0.2280, Val Acc: 1.0000
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2294, Val Acc: 1.0000
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2328, Val Acc: 1.0000
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2306, Val Acc: 1.0000
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.2043, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 38.68s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.32s
INFO:train:validation got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.11s
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=7, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 1.9456, Train Acc: 0.2100	 Val Loss: 1.9448, Val Acc: 0.2692
INFO:train:Epoch 2/100 	Train Loss: 1.9430, Train Acc: 0.4100	 Val Loss: 1.9432, Val Acc: 0.3077
INFO:train:Epoch 3/100 	Train Loss: 1.9393, Train Acc: 0.4000	 Val Loss: 1.9409, Val Acc: 0.3077
INFO:train:Epoch 4/100 	Train Loss: 1.9349, Train Acc: 0.4100	 Val Loss: 1.9376, Val Acc: 0.3077
INFO:train:Epoch 5/100 	Train Loss: 1.9296, Train Acc: 0.4200	 Val Loss: 1.9333, Val Acc: 0.3077
INFO:train:Epoch 6/100 	Train Loss: 1.9223, Train Acc: 0.4100	 Val Loss: 1.9278, Val Acc: 0.3077
INFO:train:Epoch 7/100 	Train Loss: 1.9146, Train Acc: 0.3900	 Val Loss: 1.9209, Val Acc: 0.3077
INFO:train:Epoch 8/100 	Train Loss: 1.9054, Train Acc: 0.4000	 Val Loss: 1.9127, Val Acc: 0.3077
INFO:train:Epoch 9/100 	Train Loss: 1.8938, Train Acc: 0.4100	 Val Loss: 1.9032, Val Acc: 0.3077
INFO:train:Epoch 10/100 	Train Loss: 1.8807, Train Acc: 0.4100	 Val Loss: 1.8920, Val Acc: 0.3077
INFO:train:Epoch 11/100 	Train Loss: 1.8659, Train Acc: 0.4200	 Val Loss: 1.8790, Val Acc: 0.3077
INFO:train:Epoch 12/100 	Train Loss: 1.8477, Train Acc: 0.4200	 Val Loss: 1.8643, Val Acc: 0.3077
INFO:train:Early stopping triggered after 12 epochs
INFO:train:Epoch 13/100 	Train Loss: 1.8288, Train Acc: 0.4200	 Val Loss: 1.8485, Val Acc: 0.2692
INFO:train:Early stopping triggered after 13 epochs
INFO:train:Epoch 14/100 	Train Loss: 1.8043, Train Acc: 0.4400	 Val Loss: 1.8316, Val Acc: 0.3077
INFO:train:Early stopping triggered after 14 epochs
INFO:train:Epoch 15/100 	Train Loss: 1.7795, Train Acc: 0.4500	 Val Loss: 1.8134, Val Acc: 0.3077
INFO:train:Early stopping triggered after 15 epochs
INFO:train:Epoch 16/100 	Train Loss: 1.7498, Train Acc: 0.4600	 Val Loss: 1.7951, Val Acc: 0.3077
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 1.7218, Train Acc: 0.4500	 Val Loss: 1.7779, Val Acc: 0.3077
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 1.6869, Train Acc: 0.4600	 Val Loss: 1.7630, Val Acc: 0.3462
INFO:train:Epoch 19/100 	Train Loss: 1.6526, Train Acc: 0.4600	 Val Loss: 1.7527, Val Acc: 0.3077
INFO:train:Epoch 20/100 	Train Loss: 1.6259, Train Acc: 0.4400	 Val Loss: 1.7489, Val Acc: 0.3077
INFO:train:Epoch 21/100 	Train Loss: 1.5914, Train Acc: 0.4700	 Val Loss: 1.7521, Val Acc: 0.3462
INFO:train:Epoch 22/100 	Train Loss: 1.5620, Train Acc: 0.4500	 Val Loss: 1.7614, Val Acc: 0.3462
INFO:train:Epoch 23/100 	Train Loss: 1.5398, Train Acc: 0.4600	 Val Loss: 1.7776, Val Acc: 0.3462
INFO:train:Epoch 24/100 	Train Loss: 1.5197, Train Acc: 0.4600	 Val Loss: 1.7969, Val Acc: 0.3846
INFO:train:Epoch 25/100 	Train Loss: 1.5029, Train Acc: 0.4600	 Val Loss: 1.8186, Val Acc: 0.3846
INFO:train:Epoch 26/100 	Train Loss: 1.4900, Train Acc: 0.4800	 Val Loss: 1.8405, Val Acc: 0.3846
INFO:train:Epoch 27/100 	Train Loss: 1.4769, Train Acc: 0.4800	 Val Loss: 1.8603, Val Acc: 0.3846
INFO:train:Epoch 28/100 	Train Loss: 1.4585, Train Acc: 0.5000	 Val Loss: 1.8691, Val Acc: 0.3846
INFO:train:Epoch 29/100 	Train Loss: 1.4470, Train Acc: 0.5100	 Val Loss: 1.8660, Val Acc: 0.3846
INFO:train:Epoch 30/100 	Train Loss: 1.4276, Train Acc: 0.5200	 Val Loss: 1.8533, Val Acc: 0.3846
INFO:train:Epoch 31/100 	Train Loss: 1.4135, Train Acc: 0.5400	 Val Loss: 1.8339, Val Acc: 0.3462
INFO:train:Epoch 32/100 	Train Loss: 1.3943, Train Acc: 0.5700	 Val Loss: 1.8072, Val Acc: 0.3846
INFO:train:Epoch 33/100 	Train Loss: 1.3770, Train Acc: 0.5600	 Val Loss: 1.7785, Val Acc: 0.3846
INFO:train:Epoch 34/100 	Train Loss: 1.3570, Train Acc: 0.5700	 Val Loss: 1.7479, Val Acc: 0.3846
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 1.3269, Train Acc: 0.5900	 Val Loss: 1.7219, Val Acc: 0.3846
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 1.3056, Train Acc: 0.6000	 Val Loss: 1.6979, Val Acc: 0.3846
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 1.2808, Train Acc: 0.6300	 Val Loss: 1.6835, Val Acc: 0.3846
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 1.2725, Train Acc: 0.5900	 Val Loss: 1.6812, Val Acc: 0.3846
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 1.2462, Train Acc: 0.6000	 Val Loss: 1.6881, Val Acc: 0.3846
INFO:train:Early stopping triggered after 39 epochs
INFO:train:Epoch 40/100 	Train Loss: 1.2191, Train Acc: 0.5900	 Val Loss: 1.6947, Val Acc: 0.3846
INFO:train:Early stopping triggered after 40 epochs
INFO:train:Epoch 41/100 	Train Loss: 1.1904, Train Acc: 0.6100	 Val Loss: 1.7028, Val Acc: 0.3462
INFO:train:Early stopping triggered after 41 epochs
INFO:train:Epoch 42/100 	Train Loss: 1.1685, Train Acc: 0.6500	 Val Loss: 1.7121, Val Acc: 0.4615
INFO:train:Epoch 43/100 	Train Loss: 1.1415, Train Acc: 0.7000	 Val Loss: 1.7193, Val Acc: 0.4615
INFO:train:Epoch 44/100 	Train Loss: 1.1120, Train Acc: 0.7100	 Val Loss: 1.7258, Val Acc: 0.4615
INFO:train:Epoch 45/100 	Train Loss: 1.0920, Train Acc: 0.7000	 Val Loss: 1.7378, Val Acc: 0.5385
INFO:train:Epoch 46/100 	Train Loss: 1.0772, Train Acc: 0.7200	 Val Loss: 1.7518, Val Acc: 0.5385
INFO:train:Epoch 47/100 	Train Loss: 1.0454, Train Acc: 0.7300	 Val Loss: 1.7670, Val Acc: 0.5000
INFO:train:Epoch 48/100 	Train Loss: 1.0210, Train Acc: 0.7700	 Val Loss: 1.7833, Val Acc: 0.5000
INFO:train:Epoch 49/100 	Train Loss: 1.0129, Train Acc: 0.7800	 Val Loss: 1.8001, Val Acc: 0.5385
INFO:train:Epoch 50/100 	Train Loss: 0.9984, Train Acc: 0.8000	 Val Loss: 1.8210, Val Acc: 0.5000
INFO:train:Epoch 51/100 	Train Loss: 0.9746, Train Acc: 0.8100	 Val Loss: 1.8530, Val Acc: 0.5000
INFO:train:Epoch 52/100 	Train Loss: 0.9517, Train Acc: 0.8400	 Val Loss: 1.8868, Val Acc: 0.5000
INFO:train:Epoch 53/100 	Train Loss: 0.9518, Train Acc: 0.8200	 Val Loss: 1.9175, Val Acc: 0.4615
INFO:train:Epoch 54/100 	Train Loss: 0.9449, Train Acc: 0.8300	 Val Loss: 1.9507, Val Acc: 0.4615
INFO:train:Epoch 55/100 	Train Loss: 0.9198, Train Acc: 0.8600	 Val Loss: 1.9789, Val Acc: 0.4231
INFO:train:Early stopping triggered after 55 epochs
INFO:train:Epoch 56/100 	Train Loss: 0.9137, Train Acc: 0.8600	 Val Loss: 1.9966, Val Acc: 0.4615
INFO:train:Early stopping triggered after 56 epochs
INFO:train:Epoch 57/100 	Train Loss: 0.8934, Train Acc: 0.8900	 Val Loss: 2.0052, Val Acc: 0.4615
INFO:train:Early stopping triggered after 57 epochs
INFO:train:Epoch 58/100 	Train Loss: 0.8857, Train Acc: 0.9000	 Val Loss: 2.0158, Val Acc: 0.4231
INFO:train:Early stopping triggered after 58 epochs
INFO:train:Epoch 59/100 	Train Loss: 0.8755, Train Acc: 0.8900	 Val Loss: 2.0315, Val Acc: 0.3846
INFO:train:Early stopping triggered after 59 epochs
INFO:train:Epoch 60/100 	Train Loss: 0.8735, Train Acc: 0.8800	 Val Loss: 2.0471, Val Acc: 0.3846
INFO:train:Early stopping triggered after 60 epochs
INFO:train:Epoch 61/100 	Train Loss: 0.8642, Train Acc: 0.9100	 Val Loss: 2.0668, Val Acc: 0.3846
INFO:train:Early stopping triggered after 61 epochs
INFO:train:Epoch 62/100 	Train Loss: 0.8450, Train Acc: 0.9000	 Val Loss: 2.0909, Val Acc: 0.3462
INFO:train:Early stopping triggered after 62 epochs
INFO:train:Epoch 63/100 	Train Loss: 0.8341, Train Acc: 0.9200	 Val Loss: 2.1134, Val Acc: 0.3846
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.8180, Train Acc: 0.9500	 Val Loss: 2.1274, Val Acc: 0.3462
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.8081, Train Acc: 0.9500	 Val Loss: 2.1335, Val Acc: 0.3846
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.8065, Train Acc: 0.9400	 Val Loss: 2.1464, Val Acc: 0.3846
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.7985, Train Acc: 0.9300	 Val Loss: 2.1521, Val Acc: 0.3846
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.7910, Train Acc: 0.9500	 Val Loss: 2.1465, Val Acc: 0.3462
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.7760, Train Acc: 0.9600	 Val Loss: 2.1473, Val Acc: 0.3462
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.7778, Train Acc: 0.9500	 Val Loss: 2.1570, Val Acc: 0.3462
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.7610, Train Acc: 0.9700	 Val Loss: 2.1694, Val Acc: 0.3846
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.7608, Train Acc: 0.9600	 Val Loss: 2.1526, Val Acc: 0.3462
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.7529, Train Acc: 0.9700	 Val Loss: 2.1318, Val Acc: 0.3462
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.7425, Train Acc: 0.9700	 Val Loss: 2.1351, Val Acc: 0.3846
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.7556, Train Acc: 0.9400	 Val Loss: 2.1481, Val Acc: 0.4231
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.7254, Train Acc: 0.9700	 Val Loss: 2.1668, Val Acc: 0.4615
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.7188, Train Acc: 0.9700	 Val Loss: 2.1796, Val Acc: 0.4615
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.7141, Train Acc: 0.9700	 Val Loss: 2.1529, Val Acc: 0.4231
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.7148, Train Acc: 0.9700	 Val Loss: 2.1022, Val Acc: 0.4615
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.6922, Train Acc: 0.9800	 Val Loss: 2.0746, Val Acc: 0.4231
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.6969, Train Acc: 0.9800	 Val Loss: 2.0719, Val Acc: 0.3846
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.6806, Train Acc: 0.9800	 Val Loss: 2.0960, Val Acc: 0.4615
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.6767, Train Acc: 0.9900	 Val Loss: 2.1269, Val Acc: 0.4231
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.6734, Train Acc: 0.9900	 Val Loss: 2.1488, Val Acc: 0.4231
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.6617, Train Acc: 0.9900	 Val Loss: 2.1451, Val Acc: 0.4231
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.6515, Train Acc: 1.0000	 Val Loss: 2.1345, Val Acc: 0.4615
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.6516, Train Acc: 0.9900	 Val Loss: 2.1276, Val Acc: 0.5000
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.6472, Train Acc: 1.0000	 Val Loss: 2.1319, Val Acc: 0.4615
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.6454, Train Acc: 1.0000	 Val Loss: 2.1498, Val Acc: 0.5000
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.6439, Train Acc: 1.0000	 Val Loss: 2.1787, Val Acc: 0.5000
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.6368, Train Acc: 1.0000	 Val Loss: 2.2152, Val Acc: 0.4615
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.6337, Train Acc: 1.0000	 Val Loss: 2.2329, Val Acc: 0.4615
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.6371, Train Acc: 1.0000	 Val Loss: 2.2258, Val Acc: 0.4231
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.6368, Train Acc: 1.0000	 Val Loss: 2.1978, Val Acc: 0.4615
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.6286, Train Acc: 1.0000	 Val Loss: 2.1932, Val Acc: 0.5000
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.6304, Train Acc: 1.0000	 Val Loss: 2.2016, Val Acc: 0.4615
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.6293, Train Acc: 1.0000	 Val Loss: 2.2331, Val Acc: 0.4615
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.6297, Train Acc: 1.0000	 Val Loss: 2.2545, Val Acc: 0.5000
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.6299, Train Acc: 1.0000	 Val Loss: 2.2571, Val Acc: 0.5000
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.6264, Train Acc: 1.0000	 Val Loss: 2.2552, Val Acc: 0.5000
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 50.48s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 36 / 36 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.39s
INFO:train:validation got 13 / 26 correct, accuracy: 0.5
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.17s
