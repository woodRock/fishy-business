2024-11-01 20:42:33,732 - INFO - Starting training pipeline
2024-11-01 20:42:33,732 - INFO - Loading dataset: species
2024-11-01 20:42:33,732 - INFO - Loading data from: /vol/ecrg-solar/woodj4/fishy-business/data/REIMS.xlsx
2024-11-01 20:42:43,497 - INFO - Loaded data with shape: (306, 2081)
2024-11-01 20:42:43,503 - INFO - Filtered data shape: (108, 2081)
2024-11-01 20:42:43,503 - INFO - Dataset shape after filtering: (108, 2081)
2024-11-01 20:42:43,505 - INFO - Features shape: (108, 2080), Labels shape: (108, 2)
2024-11-01 20:42:43,509 - INFO - Created DataLoader with 2 batches
2024-11-01 20:42:43,509 - INFO - Total number of samples: 108
2024-11-01 20:42:43,509 - INFO - Main training dataset size: 108 samples
2024-11-01 20:42:43,509 - INFO - Starting main training phase
2024-11-01 20:42:43,509 - INFO - Loading dataset: species
2024-11-01 20:42:43,510 - INFO - Loading data from: /vol/ecrg-solar/woodj4/fishy-business/data/REIMS.xlsx
2024-11-01 20:42:52,963 - INFO - Loaded data with shape: (306, 2081)
2024-11-01 20:42:52,967 - INFO - Filtered data shape: (108, 2081)
2024-11-01 20:42:52,968 - INFO - Dataset shape after filtering: (108, 2081)
2024-11-01 20:42:52,969 - INFO - Features shape: (108, 2080), Labels shape: (108, 2)
2024-11-01 20:42:52,970 - INFO - Created DataLoader with 2 batches
2024-11-01 20:42:52,970 - INFO - Total number of samples: 108
2024-11-01 20:42:54,190 - INFO - Created model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=2080, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=2080, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=2080, out_features=2080, bias=True)
          (key): Linear(in_features=2080, out_features=2080, bias=True)
          (value): Linear(in_features=2080, out_features=2080, bias=True)
          (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=2080, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=2080, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=2080, out_features=2, bias=True)
)
2024-11-01 20:42:54,928 - INFO - Starting k-fold cross validation training
2024-11-01 20:42:54,950 - INFO - 
Starting Fold 1/5
2024-11-01 20:42:55,639 - INFO - Epoch 1: New best validation accuracy: 1.0000
2024-11-01 20:42:55,639 - INFO - Achieved perfect validation accuracy!
2024-11-01 20:42:55,639 - INFO - Current metrics:
2024-11-01 20:42:55,639 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:42:55,639 - INFO - precision: 1.0000
2024-11-01 20:42:55,639 - INFO - recall: 1.0000
2024-11-01 20:42:55,639 - INFO - f1: 1.0000
2024-11-01 20:42:55,639 - INFO - auc_roc: 1.0000
2024-11-01 20:42:57,723 - INFO - Epoch 5
2024-11-01 20:42:57,723 - INFO - Train Loss: 0.2979
2024-11-01 20:42:57,723 - INFO - Val Loss: 0.2920
2024-11-01 20:42:57,723 - INFO - Current Val Accuracy: 1.0000
2024-11-01 20:42:57,723 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:00,332 - INFO - Epoch 10
2024-11-01 20:43:00,333 - INFO - Train Loss: 0.2376
2024-11-01 20:43:00,333 - INFO - Val Loss: 0.2269
2024-11-01 20:43:00,333 - INFO - Current Val Accuracy: 1.0000
2024-11-01 20:43:00,333 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:00,854 - INFO - Early stopping triggered after 11 epochs
2024-11-01 20:43:00,854 - INFO - Best validation accuracy: 1.0000
2024-11-01 20:43:00,862 - INFO - 
New best overall accuracy: 1.0000 (Fold 1)
2024-11-01 20:43:00,863 - INFO - 
Starting Fold 2/5
2024-11-01 20:43:01,410 - INFO - Epoch 1: New best validation accuracy: 0.9583
2024-11-01 20:43:03,505 - INFO - Epoch 5
2024-11-01 20:43:03,505 - INFO - Train Loss: 0.2943
2024-11-01 20:43:03,506 - INFO - Val Loss: 0.3651
2024-11-01 20:43:03,506 - INFO - Current Val Accuracy: 0.9500
2024-11-01 20:43:03,506 - INFO - Best Val Accuracy: 0.9583
2024-11-01 20:43:04,039 - INFO - Epoch 6: New best validation accuracy: 1.0000
2024-11-01 20:43:04,039 - INFO - Achieved perfect validation accuracy!
2024-11-01 20:43:04,039 - INFO - Current metrics:
2024-11-01 20:43:04,039 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:04,039 - INFO - precision: 1.0000
2024-11-01 20:43:04,039 - INFO - recall: 1.0000
2024-11-01 20:43:04,039 - INFO - f1: 1.0000
2024-11-01 20:43:04,039 - INFO - auc_roc: 1.0000
2024-11-01 20:43:06,138 - INFO - Epoch 10
2024-11-01 20:43:06,138 - INFO - Train Loss: 0.2450
2024-11-01 20:43:06,138 - INFO - Val Loss: 0.2167
2024-11-01 20:43:06,138 - INFO - Current Val Accuracy: 1.0000
2024-11-01 20:43:06,138 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:08,763 - INFO - Epoch 15
2024-11-01 20:43:08,763 - INFO - Train Loss: 0.2241
2024-11-01 20:43:08,763 - INFO - Val Loss: 0.2405
2024-11-01 20:43:08,763 - INFO - Current Val Accuracy: 1.0000
2024-11-01 20:43:08,763 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:09,289 - INFO - Early stopping triggered after 16 epochs
2024-11-01 20:43:09,289 - INFO - Best validation accuracy: 1.0000
2024-11-01 20:43:09,289 - INFO - 
Starting Fold 3/5
2024-11-01 20:43:09,842 - INFO - Epoch 1: New best validation accuracy: 0.9167
2024-11-01 20:43:11,427 - INFO - Epoch 4: New best validation accuracy: 0.9583
2024-11-01 20:43:11,954 - INFO - Epoch 5
2024-11-01 20:43:11,954 - INFO - Train Loss: 0.2873
2024-11-01 20:43:11,954 - INFO - Val Loss: 0.3416
2024-11-01 20:43:11,954 - INFO - Current Val Accuracy: 0.9583
2024-11-01 20:43:11,954 - INFO - Best Val Accuracy: 0.9583
2024-11-01 20:43:14,584 - INFO - Epoch 10
2024-11-01 20:43:14,584 - INFO - Train Loss: 0.2413
2024-11-01 20:43:14,585 - INFO - Val Loss: 0.3478
2024-11-01 20:43:14,585 - INFO - Current Val Accuracy: 0.8750
2024-11-01 20:43:14,585 - INFO - Best Val Accuracy: 0.9583
2024-11-01 20:43:16,692 - INFO - Early stopping triggered after 14 epochs
2024-11-01 20:43:16,692 - INFO - Best validation accuracy: 0.9583
2024-11-01 20:43:16,693 - INFO - 
Starting Fold 4/5
2024-11-01 20:43:17,256 - INFO - Epoch 1: New best validation accuracy: 0.9167
2024-11-01 20:43:18,341 - INFO - Epoch 3: New best validation accuracy: 1.0000
2024-11-01 20:43:18,341 - INFO - Achieved perfect validation accuracy!
2024-11-01 20:43:18,341 - INFO - Current metrics:
2024-11-01 20:43:18,342 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:18,342 - INFO - precision: 1.0000
2024-11-01 20:43:18,342 - INFO - recall: 1.0000
2024-11-01 20:43:18,342 - INFO - f1: 1.0000
2024-11-01 20:43:18,342 - INFO - auc_roc: 1.0000
2024-11-01 20:43:19,416 - INFO - Epoch 5
2024-11-01 20:43:19,416 - INFO - Train Loss: 0.2896
2024-11-01 20:43:19,416 - INFO - Val Loss: 0.3494
2024-11-01 20:43:19,416 - INFO - Current Val Accuracy: 0.9444
2024-11-01 20:43:19,416 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:22,108 - INFO - Epoch 10
2024-11-01 20:43:22,108 - INFO - Train Loss: 0.2323
2024-11-01 20:43:22,108 - INFO - Val Loss: 0.3593
2024-11-01 20:43:22,108 - INFO - Current Val Accuracy: 0.9028
2024-11-01 20:43:22,108 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:23,729 - INFO - Early stopping triggered after 13 epochs
2024-11-01 20:43:23,730 - INFO - Best validation accuracy: 1.0000
2024-11-01 20:43:23,730 - INFO - 
Starting Fold 5/5
2024-11-01 20:43:24,295 - INFO - Epoch 1: New best validation accuracy: 0.8611
2024-11-01 20:43:26,457 - INFO - Epoch 5
2024-11-01 20:43:26,458 - INFO - Train Loss: 0.2832
2024-11-01 20:43:26,458 - INFO - Val Loss: 0.4850
2024-11-01 20:43:26,458 - INFO - Current Val Accuracy: 0.8472
2024-11-01 20:43:26,458 - INFO - Best Val Accuracy: 0.8611
2024-11-01 20:43:28,088 - INFO - Epoch 8: New best validation accuracy: 0.8889
2024-11-01 20:43:28,638 - INFO - Epoch 9: New best validation accuracy: 1.0000
2024-11-01 20:43:28,638 - INFO - Achieved perfect validation accuracy!
2024-11-01 20:43:28,638 - INFO - Current metrics:
2024-11-01 20:43:28,638 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:28,638 - INFO - precision: 1.0000
2024-11-01 20:43:28,638 - INFO - recall: 1.0000
2024-11-01 20:43:28,638 - INFO - f1: 1.0000
2024-11-01 20:43:28,638 - INFO - auc_roc: 1.0000
2024-11-01 20:43:29,180 - INFO - Epoch 10
2024-11-01 20:43:29,180 - INFO - Train Loss: 0.2268
2024-11-01 20:43:29,180 - INFO - Val Loss: 0.2709
2024-11-01 20:43:29,180 - INFO - Current Val Accuracy: 0.9444
2024-11-01 20:43:29,180 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:31,890 - INFO - Epoch 15
2024-11-01 20:43:31,890 - INFO - Train Loss: 0.2118
2024-11-01 20:43:31,890 - INFO - Val Loss: 0.3406
2024-11-01 20:43:31,890 - INFO - Current Val Accuracy: 0.9028
2024-11-01 20:43:31,890 - INFO - Best Val Accuracy: 1.0000
2024-11-01 20:43:34,063 - INFO - Early stopping triggered after 19 epochs
2024-11-01 20:43:34,063 - INFO - Best validation accuracy: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Best validation metrics for each fold:
2024-11-01 20:43:34,064 - INFO - 
Fold 1:
2024-11-01 20:43:34,064 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:34,064 - INFO - precision: 1.0000
2024-11-01 20:43:34,064 - INFO - recall: 1.0000
2024-11-01 20:43:34,064 - INFO - f1: 1.0000
2024-11-01 20:43:34,064 - INFO - auc_roc: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Fold 2:
2024-11-01 20:43:34,064 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:34,064 - INFO - precision: 1.0000
2024-11-01 20:43:34,064 - INFO - recall: 1.0000
2024-11-01 20:43:34,064 - INFO - f1: 1.0000
2024-11-01 20:43:34,064 - INFO - auc_roc: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Fold 3:
2024-11-01 20:43:34,064 - INFO - balanced_accuracy: 0.9583
2024-11-01 20:43:34,064 - INFO - precision: 0.9587
2024-11-01 20:43:34,064 - INFO - recall: 0.9545
2024-11-01 20:43:34,064 - INFO - f1: 0.9546
2024-11-01 20:43:34,064 - INFO - auc_roc: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Fold 4:
2024-11-01 20:43:34,064 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:34,064 - INFO - precision: 1.0000
2024-11-01 20:43:34,064 - INFO - recall: 1.0000
2024-11-01 20:43:34,064 - INFO - f1: 1.0000
2024-11-01 20:43:34,064 - INFO - auc_roc: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Fold 5:
2024-11-01 20:43:34,064 - INFO - balanced_accuracy: 1.0000
2024-11-01 20:43:34,064 - INFO - precision: 1.0000
2024-11-01 20:43:34,064 - INFO - recall: 1.0000
2024-11-01 20:43:34,064 - INFO - f1: 1.0000
2024-11-01 20:43:34,064 - INFO - auc_roc: 1.0000
2024-11-01 20:43:34,064 - INFO - 
Average metrics across all folds:
2024-11-01 20:43:34,064 - INFO - Average balanced_accuracy: 0.9917
2024-11-01 20:43:34,064 - INFO - Average precision: 0.9917
2024-11-01 20:43:34,064 - INFO - Average recall: 0.9909
2024-11-01 20:43:34,064 - INFO - Average f1: 0.9909
2024-11-01 20:43:34,064 - INFO - Average auc_roc: 1.0000
2024-11-01 20:43:34,065 - INFO - 
Metric standard deviations across folds:
2024-11-01 20:43:34,065 - INFO - balanced_accuracy std: 0.0167
2024-11-01 20:43:34,065 - INFO - precision std: 0.0165
2024-11-01 20:43:34,065 - INFO - recall std: 0.0182
2024-11-01 20:43:34,065 - INFO - f1 std: 0.0181
2024-11-01 20:43:34,065 - INFO - auc_roc std: 0.0000
2024-11-01 20:43:34,065 - INFO - 
Training completed. Best overall accuracy: 1.0000
2024-11-01 20:43:34,073 - INFO - Training time: 39.15s
2024-11-01 20:43:35,874 - INFO - Saving attention map to: figures/encoder_attention_map.png
2024-11-01 20:43:36,094 - INFO - Saving attention map to: figures/decoder_attention_map.png
2024-11-01 20:43:36,106 - INFO - Training pipeline completed successfully
2024-11-01 20:43:36,106 - INFO - Final training dataset size: 108 samples
2024-11-01 20:43:36,106 - INFO - Original dataset shape: (306, 2081)
