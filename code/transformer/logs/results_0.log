INFO:__main__:Reading the dataset: fish species
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=2, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 0.9318, Train Acc: 0.3721	 Val Loss: 0.5714, Val Acc: 0.7273
INFO:train:Epoch 2/100 	Train Loss: 0.5664, Train Acc: 0.7093	 Val Loss: 0.3944, Val Acc: 0.8636
INFO:train:Epoch 3/100 	Train Loss: 0.3607, Train Acc: 0.9186	 Val Loss: 0.2975, Val Acc: 1.0000
INFO:train:Epoch 4/100 	Train Loss: 0.3072, Train Acc: 0.9302	 Val Loss: 0.2631, Val Acc: 1.0000
INFO:train:Epoch 5/100 	Train Loss: 0.2710, Train Acc: 0.9535	 Val Loss: 0.2471, Val Acc: 1.0000
INFO:train:Epoch 6/100 	Train Loss: 0.2592, Train Acc: 0.9651	 Val Loss: 0.2432, Val Acc: 1.0000
INFO:train:Epoch 7/100 	Train Loss: 0.2544, Train Acc: 0.9884	 Val Loss: 0.2405, Val Acc: 1.0000
INFO:train:Epoch 8/100 	Train Loss: 0.2595, Train Acc: 0.9884	 Val Loss: 0.2401, Val Acc: 1.0000
INFO:train:Epoch 9/100 	Train Loss: 0.2475, Train Acc: 1.0000	 Val Loss: 0.2389, Val Acc: 1.0000
INFO:train:Epoch 10/100 	Train Loss: 0.2425, Train Acc: 1.0000	 Val Loss: 0.2397, Val Acc: 1.0000
INFO:train:Epoch 11/100 	Train Loss: 0.2407, Train Acc: 1.0000	 Val Loss: 0.2427, Val Acc: 1.0000
INFO:train:Epoch 12/100 	Train Loss: 0.2401, Train Acc: 1.0000	 Val Loss: 0.2396, Val Acc: 1.0000
INFO:train:Epoch 13/100 	Train Loss: 0.2356, Train Acc: 1.0000	 Val Loss: 0.2348, Val Acc: 1.0000
INFO:train:Early stopping triggered after 13 epochs
INFO:train:Epoch 14/100 	Train Loss: 0.2308, Train Acc: 1.0000	 Val Loss: 0.2318, Val Acc: 1.0000
INFO:train:Early stopping triggered after 14 epochs
INFO:train:Epoch 15/100 	Train Loss: 0.2276, Train Acc: 1.0000	 Val Loss: 0.2311, Val Acc: 1.0000
INFO:train:Early stopping triggered after 15 epochs
INFO:train:Epoch 16/100 	Train Loss: 0.2214, Train Acc: 1.0000	 Val Loss: 0.2318, Val Acc: 1.0000
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 0.2219, Train Acc: 1.0000	 Val Loss: 0.2299, Val Acc: 1.0000
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 0.2162, Train Acc: 1.0000	 Val Loss: 0.2269, Val Acc: 1.0000
INFO:train:Early stopping triggered after 18 epochs
INFO:train:Epoch 19/100 	Train Loss: 0.2191, Train Acc: 1.0000	 Val Loss: 0.2272, Val Acc: 1.0000
INFO:train:Early stopping triggered after 19 epochs
INFO:train:Epoch 20/100 	Train Loss: 0.2165, Train Acc: 1.0000	 Val Loss: 0.2241, Val Acc: 1.0000
INFO:train:Early stopping triggered after 20 epochs
INFO:train:Epoch 21/100 	Train Loss: 0.2136, Train Acc: 1.0000	 Val Loss: 0.2258, Val Acc: 1.0000
INFO:train:Early stopping triggered after 21 epochs
INFO:train:Epoch 22/100 	Train Loss: 0.2222, Train Acc: 1.0000	 Val Loss: 0.2206, Val Acc: 1.0000
INFO:train:Early stopping triggered after 22 epochs
INFO:train:Epoch 23/100 	Train Loss: 0.2115, Train Acc: 1.0000	 Val Loss: 0.2213, Val Acc: 1.0000
INFO:train:Early stopping triggered after 23 epochs
INFO:train:Epoch 24/100 	Train Loss: 0.2146, Train Acc: 1.0000	 Val Loss: 0.2224, Val Acc: 1.0000
INFO:train:Early stopping triggered after 24 epochs
INFO:train:Epoch 25/100 	Train Loss: 0.2115, Train Acc: 1.0000	 Val Loss: 0.2267, Val Acc: 1.0000
INFO:train:Early stopping triggered after 25 epochs
INFO:train:Epoch 26/100 	Train Loss: 0.2139, Train Acc: 1.0000	 Val Loss: 0.2284, Val Acc: 1.0000
INFO:train:Early stopping triggered after 26 epochs
INFO:train:Epoch 27/100 	Train Loss: 0.2119, Train Acc: 1.0000	 Val Loss: 0.2243, Val Acc: 1.0000
INFO:train:Early stopping triggered after 27 epochs
INFO:train:Epoch 28/100 	Train Loss: 0.2129, Train Acc: 1.0000	 Val Loss: 0.2245, Val Acc: 1.0000
INFO:train:Early stopping triggered after 28 epochs
INFO:train:Epoch 29/100 	Train Loss: 0.2117, Train Acc: 1.0000	 Val Loss: 0.2320, Val Acc: 1.0000
INFO:train:Early stopping triggered after 29 epochs
INFO:train:Epoch 30/100 	Train Loss: 0.2152, Train Acc: 1.0000	 Val Loss: 0.2264, Val Acc: 1.0000
INFO:train:Early stopping triggered after 30 epochs
INFO:train:Epoch 31/100 	Train Loss: 0.2143, Train Acc: 1.0000	 Val Loss: 0.2299, Val Acc: 1.0000
INFO:train:Early stopping triggered after 31 epochs
INFO:train:Epoch 32/100 	Train Loss: 0.2115, Train Acc: 1.0000	 Val Loss: 0.2235, Val Acc: 1.0000
INFO:train:Early stopping triggered after 32 epochs
INFO:train:Epoch 33/100 	Train Loss: 0.2119, Train Acc: 1.0000	 Val Loss: 0.2253, Val Acc: 1.0000
INFO:train:Early stopping triggered after 33 epochs
INFO:train:Epoch 34/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 0.2079, Train Acc: 1.0000	 Val Loss: 0.2220, Val Acc: 1.0000
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2209, Val Acc: 1.0000
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 0.2076, Train Acc: 1.0000	 Val Loss: 0.2202, Val Acc: 1.0000
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2217, Val Acc: 1.0000
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 0.2059, Train Acc: 1.0000	 Val Loss: 0.2232, Val Acc: 1.0000
INFO:train:Early stopping triggered after 39 epochs
INFO:train:Epoch 40/100 	Train Loss: 0.2091, Train Acc: 1.0000	 Val Loss: 0.2219, Val Acc: 1.0000
INFO:train:Early stopping triggered after 40 epochs
INFO:train:Epoch 41/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2217, Val Acc: 1.0000
INFO:train:Early stopping triggered after 41 epochs
INFO:train:Epoch 42/100 	Train Loss: 0.2088, Train Acc: 1.0000	 Val Loss: 0.2197, Val Acc: 1.0000
INFO:train:Early stopping triggered after 42 epochs
INFO:train:Epoch 43/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2242, Val Acc: 1.0000
INFO:train:Early stopping triggered after 43 epochs
INFO:train:Epoch 44/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2205, Val Acc: 1.0000
INFO:train:Early stopping triggered after 44 epochs
INFO:train:Epoch 45/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2264, Val Acc: 1.0000
INFO:train:Early stopping triggered after 45 epochs
INFO:train:Epoch 46/100 	Train Loss: 0.2084, Train Acc: 1.0000	 Val Loss: 0.2233, Val Acc: 1.0000
INFO:train:Early stopping triggered after 46 epochs
INFO:train:Epoch 47/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2235, Val Acc: 1.0000
INFO:train:Early stopping triggered after 47 epochs
INFO:train:Epoch 48/100 	Train Loss: 0.2070, Train Acc: 1.0000	 Val Loss: 0.2244, Val Acc: 1.0000
INFO:train:Early stopping triggered after 48 epochs
INFO:train:Epoch 49/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2240, Val Acc: 1.0000
INFO:train:Early stopping triggered after 49 epochs
INFO:train:Epoch 50/100 	Train Loss: 0.2057, Train Acc: 1.0000	 Val Loss: 0.2242, Val Acc: 1.0000
INFO:train:Early stopping triggered after 50 epochs
INFO:train:Epoch 51/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2246, Val Acc: 1.0000
INFO:train:Early stopping triggered after 51 epochs
INFO:train:Epoch 52/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2245, Val Acc: 1.0000
INFO:train:Early stopping triggered after 52 epochs
INFO:train:Epoch 53/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2246, Val Acc: 1.0000
INFO:train:Early stopping triggered after 53 epochs
INFO:train:Epoch 54/100 	Train Loss: 0.2084, Train Acc: 1.0000	 Val Loss: 0.2226, Val Acc: 1.0000
INFO:train:Early stopping triggered after 54 epochs
INFO:train:Epoch 55/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2272, Val Acc: 1.0000
INFO:train:Early stopping triggered after 55 epochs
INFO:train:Epoch 56/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2296, Val Acc: 1.0000
INFO:train:Early stopping triggered after 56 epochs
INFO:train:Epoch 57/100 	Train Loss: 0.2038, Train Acc: 1.0000	 Val Loss: 0.2265, Val Acc: 1.0000
INFO:train:Early stopping triggered after 57 epochs
INFO:train:Epoch 58/100 	Train Loss: 0.2059, Train Acc: 1.0000	 Val Loss: 0.2318, Val Acc: 1.0000
INFO:train:Early stopping triggered after 58 epochs
INFO:train:Epoch 59/100 	Train Loss: 0.2055, Train Acc: 1.0000	 Val Loss: 0.2317, Val Acc: 1.0000
INFO:train:Early stopping triggered after 59 epochs
INFO:train:Epoch 60/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2250, Val Acc: 1.0000
INFO:train:Early stopping triggered after 60 epochs
INFO:train:Epoch 61/100 	Train Loss: 0.2071, Train Acc: 1.0000	 Val Loss: 0.2255, Val Acc: 1.0000
INFO:train:Early stopping triggered after 61 epochs
INFO:train:Epoch 62/100 	Train Loss: 0.2054, Train Acc: 1.0000	 Val Loss: 0.2283, Val Acc: 1.0000
INFO:train:Early stopping triggered after 62 epochs
INFO:train:Epoch 63/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2248, Val Acc: 1.0000
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2241, Val Acc: 1.0000
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2232, Val Acc: 1.0000
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.2075, Train Acc: 1.0000	 Val Loss: 0.2203, Val Acc: 1.0000
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2199, Val Acc: 1.0000
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.2041, Train Acc: 1.0000	 Val Loss: 0.2198, Val Acc: 1.0000
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2219, Val Acc: 1.0000
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.2065, Train Acc: 1.0000	 Val Loss: 0.2233, Val Acc: 1.0000
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2216, Val Acc: 1.0000
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.2057, Train Acc: 1.0000	 Val Loss: 0.2221, Val Acc: 1.0000
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2257, Val Acc: 1.0000
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.2047, Train Acc: 1.0000	 Val Loss: 0.2235, Val Acc: 1.0000
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.2078, Train Acc: 1.0000	 Val Loss: 0.2228, Val Acc: 1.0000
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.2052, Train Acc: 1.0000	 Val Loss: 0.2225, Val Acc: 1.0000
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.2035, Train Acc: 1.0000	 Val Loss: 0.2260, Val Acc: 1.0000
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.2038, Train Acc: 1.0000	 Val Loss: 0.2217, Val Acc: 1.0000
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.2049, Train Acc: 1.0000	 Val Loss: 0.2244, Val Acc: 1.0000
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2286, Val Acc: 1.0000
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.2042, Train Acc: 1.0000	 Val Loss: 0.2285, Val Acc: 1.0000
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.2054, Train Acc: 1.0000	 Val Loss: 0.2253, Val Acc: 1.0000
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.2047, Train Acc: 1.0000	 Val Loss: 0.2283, Val Acc: 1.0000
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.2067, Train Acc: 1.0000	 Val Loss: 0.2271, Val Acc: 1.0000
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2226, Val Acc: 1.0000
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2226, Val Acc: 1.0000
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.2066, Train Acc: 1.0000	 Val Loss: 0.2216, Val Acc: 1.0000
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2204, Val Acc: 1.0000
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2190, Val Acc: 1.0000
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2187, Val Acc: 1.0000
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.2073, Train Acc: 1.0000	 Val Loss: 0.2182, Val Acc: 1.0000
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2203, Val Acc: 1.0000
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2215, Val Acc: 1.0000
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.2050, Train Acc: 1.0000	 Val Loss: 0.2218, Val Acc: 1.0000
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.2070, Train Acc: 1.0000	 Val Loss: 0.2226, Val Acc: 1.0000
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2226, Val Acc: 1.0000
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2197, Val Acc: 1.0000
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.2043, Train Acc: 1.0000	 Val Loss: 0.2190, Val Acc: 1.0000
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2182, Val Acc: 1.0000
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.2049, Train Acc: 1.0000	 Val Loss: 0.2175, Val Acc: 1.0000
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 41.13s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.30s
INFO:train:validation got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.10s
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=7, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 1.9456, Train Acc: 0.2200	 Val Loss: 1.9446, Val Acc: 0.2692
INFO:train:Epoch 2/100 	Train Loss: 1.9428, Train Acc: 0.3900	 Val Loss: 1.9430, Val Acc: 0.2692
INFO:train:Epoch 3/100 	Train Loss: 1.9394, Train Acc: 0.3700	 Val Loss: 1.9406, Val Acc: 0.2692
INFO:train:Epoch 4/100 	Train Loss: 1.9350, Train Acc: 0.3700	 Val Loss: 1.9374, Val Acc: 0.3077
INFO:train:Epoch 5/100 	Train Loss: 1.9291, Train Acc: 0.3600	 Val Loss: 1.9333, Val Acc: 0.3077
INFO:train:Epoch 6/100 	Train Loss: 1.9230, Train Acc: 0.3800	 Val Loss: 1.9281, Val Acc: 0.3077
INFO:train:Epoch 7/100 	Train Loss: 1.9152, Train Acc: 0.3700	 Val Loss: 1.9215, Val Acc: 0.3077
INFO:train:Epoch 8/100 	Train Loss: 1.9050, Train Acc: 0.3700	 Val Loss: 1.9133, Val Acc: 0.3077
INFO:train:Epoch 9/100 	Train Loss: 1.8938, Train Acc: 0.3700	 Val Loss: 1.9037, Val Acc: 0.3077
INFO:train:Epoch 10/100 	Train Loss: 1.8808, Train Acc: 0.3600	 Val Loss: 1.8928, Val Acc: 0.3077
INFO:train:Epoch 11/100 	Train Loss: 1.8654, Train Acc: 0.3900	 Val Loss: 1.8807, Val Acc: 0.3077
INFO:train:Epoch 12/100 	Train Loss: 1.8485, Train Acc: 0.3900	 Val Loss: 1.8670, Val Acc: 0.3077
INFO:train:Epoch 13/100 	Train Loss: 1.8279, Train Acc: 0.3900	 Val Loss: 1.8520, Val Acc: 0.2692
INFO:train:Epoch 14/100 	Train Loss: 1.8061, Train Acc: 0.4000	 Val Loss: 1.8358, Val Acc: 0.2692
INFO:train:Early stopping triggered after 14 epochs
INFO:train:Epoch 15/100 	Train Loss: 1.7803, Train Acc: 0.4500	 Val Loss: 1.8184, Val Acc: 0.2692
INFO:train:Early stopping triggered after 15 epochs
INFO:train:Epoch 16/100 	Train Loss: 1.7514, Train Acc: 0.4400	 Val Loss: 1.8007, Val Acc: 0.2692
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 1.7234, Train Acc: 0.4600	 Val Loss: 1.7844, Val Acc: 0.3077
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 1.6906, Train Acc: 0.4800	 Val Loss: 1.7692, Val Acc: 0.3077
INFO:train:Early stopping triggered after 18 epochs
INFO:train:Epoch 19/100 	Train Loss: 1.6558, Train Acc: 0.4600	 Val Loss: 1.7574, Val Acc: 0.3077
INFO:train:Early stopping triggered after 19 epochs
INFO:train:Epoch 20/100 	Train Loss: 1.6264, Train Acc: 0.4500	 Val Loss: 1.7517, Val Acc: 0.3077
INFO:train:Early stopping triggered after 20 epochs
INFO:train:Epoch 21/100 	Train Loss: 1.5870, Train Acc: 0.4800	 Val Loss: 1.7530, Val Acc: 0.3846
INFO:train:Epoch 22/100 	Train Loss: 1.5620, Train Acc: 0.5000	 Val Loss: 1.7620, Val Acc: 0.3846
INFO:train:Epoch 23/100 	Train Loss: 1.5352, Train Acc: 0.4600	 Val Loss: 1.7789, Val Acc: 0.3462
INFO:train:Epoch 24/100 	Train Loss: 1.5131, Train Acc: 0.4900	 Val Loss: 1.8000, Val Acc: 0.3846
INFO:train:Epoch 25/100 	Train Loss: 1.5039, Train Acc: 0.4500	 Val Loss: 1.8209, Val Acc: 0.3846
INFO:train:Epoch 26/100 	Train Loss: 1.4817, Train Acc: 0.5100	 Val Loss: 1.8391, Val Acc: 0.3846
INFO:train:Epoch 27/100 	Train Loss: 1.4729, Train Acc: 0.5000	 Val Loss: 1.8534, Val Acc: 0.3462
INFO:train:Epoch 28/100 	Train Loss: 1.4550, Train Acc: 0.5000	 Val Loss: 1.8574, Val Acc: 0.3462
INFO:train:Epoch 29/100 	Train Loss: 1.4378, Train Acc: 0.5300	 Val Loss: 1.8599, Val Acc: 0.3462
INFO:train:Epoch 30/100 	Train Loss: 1.4274, Train Acc: 0.5300	 Val Loss: 1.8502, Val Acc: 0.3077
INFO:train:Epoch 31/100 	Train Loss: 1.4082, Train Acc: 0.5500	 Val Loss: 1.8382, Val Acc: 0.3077
INFO:train:Early stopping triggered after 31 epochs
INFO:train:Epoch 32/100 	Train Loss: 1.3929, Train Acc: 0.5400	 Val Loss: 1.8250, Val Acc: 0.3462
INFO:train:Early stopping triggered after 32 epochs
INFO:train:Epoch 33/100 	Train Loss: 1.3687, Train Acc: 0.5600	 Val Loss: 1.8087, Val Acc: 0.3462
INFO:train:Early stopping triggered after 33 epochs
INFO:train:Epoch 34/100 	Train Loss: 1.3490, Train Acc: 0.5800	 Val Loss: 1.7927, Val Acc: 0.3846
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 1.3226, Train Acc: 0.5800	 Val Loss: 1.7716, Val Acc: 0.3846
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 1.2994, Train Acc: 0.5700	 Val Loss: 1.7469, Val Acc: 0.3846
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 1.2739, Train Acc: 0.5900	 Val Loss: 1.7231, Val Acc: 0.3846
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 1.2453, Train Acc: 0.6100	 Val Loss: 1.7056, Val Acc: 0.3846
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 1.2201, Train Acc: 0.6400	 Val Loss: 1.6972, Val Acc: 0.4231
INFO:train:Epoch 40/100 	Train Loss: 1.2046, Train Acc: 0.6500	 Val Loss: 1.6971, Val Acc: 0.4615
INFO:train:Epoch 41/100 	Train Loss: 1.1726, Train Acc: 0.6600	 Val Loss: 1.7067, Val Acc: 0.4615
INFO:train:Epoch 42/100 	Train Loss: 1.1441, Train Acc: 0.7000	 Val Loss: 1.7189, Val Acc: 0.4615
INFO:train:Epoch 43/100 	Train Loss: 1.1207, Train Acc: 0.7400	 Val Loss: 1.7313, Val Acc: 0.4615
INFO:train:Epoch 44/100 	Train Loss: 1.1088, Train Acc: 0.7200	 Val Loss: 1.7438, Val Acc: 0.5385
INFO:train:Epoch 45/100 	Train Loss: 1.0817, Train Acc: 0.7200	 Val Loss: 1.7545, Val Acc: 0.5385
INFO:train:Epoch 46/100 	Train Loss: 1.0602, Train Acc: 0.7400	 Val Loss: 1.7677, Val Acc: 0.5385
INFO:train:Epoch 47/100 	Train Loss: 1.0301, Train Acc: 0.7700	 Val Loss: 1.7830, Val Acc: 0.5385
INFO:train:Epoch 48/100 	Train Loss: 1.0123, Train Acc: 0.8300	 Val Loss: 1.7996, Val Acc: 0.5000
INFO:train:Epoch 49/100 	Train Loss: 0.9908, Train Acc: 0.7900	 Val Loss: 1.8188, Val Acc: 0.5000
INFO:train:Epoch 50/100 	Train Loss: 0.9782, Train Acc: 0.8100	 Val Loss: 1.8390, Val Acc: 0.5000
INFO:train:Epoch 51/100 	Train Loss: 0.9513, Train Acc: 0.8300	 Val Loss: 1.8617, Val Acc: 0.5000
INFO:train:Epoch 52/100 	Train Loss: 0.9418, Train Acc: 0.8400	 Val Loss: 1.8960, Val Acc: 0.5385
INFO:train:Epoch 53/100 	Train Loss: 0.9283, Train Acc: 0.8700	 Val Loss: 1.9242, Val Acc: 0.5769
INFO:train:Epoch 54/100 	Train Loss: 0.9027, Train Acc: 0.8800	 Val Loss: 1.9501, Val Acc: 0.5385
INFO:train:Epoch 55/100 	Train Loss: 0.8936, Train Acc: 0.8800	 Val Loss: 1.9773, Val Acc: 0.5000
INFO:train:Epoch 56/100 	Train Loss: 0.8933, Train Acc: 0.8700	 Val Loss: 1.9973, Val Acc: 0.4615
INFO:train:Epoch 57/100 	Train Loss: 0.8769, Train Acc: 0.8900	 Val Loss: 2.0164, Val Acc: 0.4615
INFO:train:Epoch 58/100 	Train Loss: 0.8612, Train Acc: 0.9000	 Val Loss: 2.0357, Val Acc: 0.4231
INFO:train:Epoch 59/100 	Train Loss: 0.8604, Train Acc: 0.9100	 Val Loss: 2.0476, Val Acc: 0.4231
INFO:train:Epoch 60/100 	Train Loss: 0.8337, Train Acc: 0.9100	 Val Loss: 2.0547, Val Acc: 0.4231
INFO:train:Epoch 61/100 	Train Loss: 0.8387, Train Acc: 0.9100	 Val Loss: 2.0748, Val Acc: 0.4615
INFO:train:Epoch 62/100 	Train Loss: 0.8180, Train Acc: 0.9000	 Val Loss: 2.0966, Val Acc: 0.4615
INFO:train:Epoch 63/100 	Train Loss: 0.8037, Train Acc: 0.9200	 Val Loss: 2.1006, Val Acc: 0.4615
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.7971, Train Acc: 0.9400	 Val Loss: 2.1073, Val Acc: 0.4231
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.7857, Train Acc: 0.9400	 Val Loss: 2.1162, Val Acc: 0.3846
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.7830, Train Acc: 0.9500	 Val Loss: 2.1486, Val Acc: 0.4231
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.7700, Train Acc: 0.9600	 Val Loss: 2.1910, Val Acc: 0.4615
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.7699, Train Acc: 0.9500	 Val Loss: 2.1767, Val Acc: 0.4231
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.7522, Train Acc: 0.9600	 Val Loss: 2.1466, Val Acc: 0.4231
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.7366, Train Acc: 0.9700	 Val Loss: 2.1263, Val Acc: 0.4231
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.7399, Train Acc: 0.9700	 Val Loss: 2.1250, Val Acc: 0.4231
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.7292, Train Acc: 0.9600	 Val Loss: 2.1414, Val Acc: 0.4615
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.7273, Train Acc: 0.9700	 Val Loss: 2.1426, Val Acc: 0.4231
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.7144, Train Acc: 0.9700	 Val Loss: 2.1297, Val Acc: 0.4615
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.7080, Train Acc: 0.9700	 Val Loss: 2.1198, Val Acc: 0.4231
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.7072, Train Acc: 0.9600	 Val Loss: 2.1140, Val Acc: 0.3846
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.6930, Train Acc: 0.9800	 Val Loss: 2.1257, Val Acc: 0.4231
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.6830, Train Acc: 0.9800	 Val Loss: 2.1090, Val Acc: 0.4231
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.6804, Train Acc: 1.0000	 Val Loss: 2.0837, Val Acc: 0.4231
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.6762, Train Acc: 0.9900	 Val Loss: 2.0719, Val Acc: 0.4231
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.6647, Train Acc: 1.0000	 Val Loss: 2.0944, Val Acc: 0.4615
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.6667, Train Acc: 1.0000	 Val Loss: 2.1372, Val Acc: 0.4231
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.6544, Train Acc: 1.0000	 Val Loss: 2.1809, Val Acc: 0.4615
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.6497, Train Acc: 1.0000	 Val Loss: 2.2284, Val Acc: 0.4615
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.6418, Train Acc: 1.0000	 Val Loss: 2.2342, Val Acc: 0.4615
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.6452, Train Acc: 1.0000	 Val Loss: 2.2215, Val Acc: 0.4231
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.6395, Train Acc: 1.0000	 Val Loss: 2.2132, Val Acc: 0.4231
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.6369, Train Acc: 1.0000	 Val Loss: 2.2056, Val Acc: 0.4231
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.6318, Train Acc: 1.0000	 Val Loss: 2.2071, Val Acc: 0.4231
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.6390, Train Acc: 1.0000	 Val Loss: 2.2042, Val Acc: 0.4231
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.6309, Train Acc: 1.0000	 Val Loss: 2.1981, Val Acc: 0.4231
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.6287, Train Acc: 1.0000	 Val Loss: 2.2230, Val Acc: 0.4231
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.6287, Train Acc: 1.0000	 Val Loss: 2.2404, Val Acc: 0.4615
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.6271, Train Acc: 1.0000	 Val Loss: 2.2434, Val Acc: 0.4615
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.6228, Train Acc: 1.0000	 Val Loss: 2.2439, Val Acc: 0.4615
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.6282, Train Acc: 1.0000	 Val Loss: 2.2396, Val Acc: 0.4615
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.6258, Train Acc: 1.0000	 Val Loss: 2.2357, Val Acc: 0.4615
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.6255, Train Acc: 1.0000	 Val Loss: 2.2452, Val Acc: 0.4615
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.6217, Train Acc: 1.0000	 Val Loss: 2.2624, Val Acc: 0.4615
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.6244, Train Acc: 1.0000	 Val Loss: 2.2689, Val Acc: 0.4615
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 43.42s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 36 / 36 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.43s
INFO:train:validation got 12 / 26 correct, accuracy: 0.46153846153846156
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.15s
