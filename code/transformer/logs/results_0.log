INFO:__main__:Reading the dataset: fish species
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=3, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 1.1712, Train Acc: 0.3689	 Val Loss: 0.9776, Val Acc: 0.4839
INFO:train:Epoch 2/100 	Train Loss: 0.8291, Train Acc: 0.6557	 Val Loss: 0.8749, Val Acc: 0.6129
INFO:train:Epoch 3/100 	Train Loss: 0.7412, Train Acc: 0.7377	 Val Loss: 0.6937, Val Acc: 0.7742
INFO:train:Epoch 4/100 	Train Loss: 0.6110, Train Acc: 0.8115	 Val Loss: 0.6286, Val Acc: 0.8065
INFO:train:Epoch 5/100 	Train Loss: 0.5548, Train Acc: 0.8852	 Val Loss: 0.6095, Val Acc: 0.7742
INFO:train:Epoch 6/100 	Train Loss: 0.5065, Train Acc: 0.8934	 Val Loss: 0.6052, Val Acc: 0.8065
INFO:train:Epoch 7/100 	Train Loss: 0.4532, Train Acc: 0.9344	 Val Loss: 0.6481, Val Acc: 0.7419
INFO:train:Epoch 8/100 	Train Loss: 0.4506, Train Acc: 0.9426	 Val Loss: 0.6726, Val Acc: 0.7419
INFO:train:Epoch 9/100 	Train Loss: 0.4180, Train Acc: 0.9590	 Val Loss: 0.6721, Val Acc: 0.7419
INFO:train:Epoch 10/100 	Train Loss: 0.4184, Train Acc: 0.9508	 Val Loss: 0.6472, Val Acc: 0.7419
INFO:train:Epoch 11/100 	Train Loss: 0.3875, Train Acc: 0.9836	 Val Loss: 0.6245, Val Acc: 0.7742
INFO:train:Epoch 12/100 	Train Loss: 0.3823, Train Acc: 1.0000	 Val Loss: 0.6256, Val Acc: 0.7742
INFO:train:Epoch 13/100 	Train Loss: 0.3784, Train Acc: 0.9918	 Val Loss: 0.6261, Val Acc: 0.7742
INFO:train:Epoch 14/100 	Train Loss: 0.3606, Train Acc: 1.0000	 Val Loss: 0.6400, Val Acc: 0.7419
INFO:train:Early stopping triggered after 14 epochs
INFO:train:Epoch 15/100 	Train Loss: 0.3614, Train Acc: 1.0000	 Val Loss: 0.6600, Val Acc: 0.7419
INFO:train:Early stopping triggered after 15 epochs
INFO:train:Epoch 16/100 	Train Loss: 0.3492, Train Acc: 1.0000	 Val Loss: 0.6454, Val Acc: 0.7419
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 0.3540, Train Acc: 0.9918	 Val Loss: 0.6416, Val Acc: 0.7419
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 0.3459, Train Acc: 1.0000	 Val Loss: 0.6209, Val Acc: 0.7419
INFO:train:Early stopping triggered after 18 epochs
INFO:train:Epoch 19/100 	Train Loss: 0.3403, Train Acc: 0.9918	 Val Loss: 0.6199, Val Acc: 0.7742
INFO:train:Early stopping triggered after 19 epochs
INFO:train:Epoch 20/100 	Train Loss: 0.3341, Train Acc: 1.0000	 Val Loss: 0.6427, Val Acc: 0.7419
INFO:train:Early stopping triggered after 20 epochs
INFO:train:Epoch 21/100 	Train Loss: 0.3320, Train Acc: 1.0000	 Val Loss: 0.6629, Val Acc: 0.7419
INFO:train:Early stopping triggered after 21 epochs
INFO:train:Epoch 22/100 	Train Loss: 0.3313, Train Acc: 1.0000	 Val Loss: 0.6622, Val Acc: 0.7419
INFO:train:Early stopping triggered after 22 epochs
INFO:train:Epoch 23/100 	Train Loss: 0.3314, Train Acc: 1.0000	 Val Loss: 0.6390, Val Acc: 0.7419
INFO:train:Early stopping triggered after 23 epochs
INFO:train:Epoch 24/100 	Train Loss: 0.3231, Train Acc: 1.0000	 Val Loss: 0.6331, Val Acc: 0.7742
INFO:train:Early stopping triggered after 24 epochs
INFO:train:Epoch 25/100 	Train Loss: 0.3271, Train Acc: 1.0000	 Val Loss: 0.6472, Val Acc: 0.7419
INFO:train:Early stopping triggered after 25 epochs
INFO:train:Epoch 26/100 	Train Loss: 0.3224, Train Acc: 1.0000	 Val Loss: 0.6274, Val Acc: 0.7742
INFO:train:Early stopping triggered after 26 epochs
INFO:train:Epoch 27/100 	Train Loss: 0.3250, Train Acc: 1.0000	 Val Loss: 0.6335, Val Acc: 0.7419
INFO:train:Early stopping triggered after 27 epochs
INFO:train:Epoch 28/100 	Train Loss: 0.3243, Train Acc: 1.0000	 Val Loss: 0.6188, Val Acc: 0.7419
INFO:train:Early stopping triggered after 28 epochs
INFO:train:Epoch 29/100 	Train Loss: 0.3278, Train Acc: 1.0000	 Val Loss: 0.6132, Val Acc: 0.7419
INFO:train:Early stopping triggered after 29 epochs
INFO:train:Epoch 30/100 	Train Loss: 0.3189, Train Acc: 1.0000	 Val Loss: 0.6113, Val Acc: 0.7419
INFO:train:Early stopping triggered after 30 epochs
INFO:train:Epoch 31/100 	Train Loss: 0.3198, Train Acc: 1.0000	 Val Loss: 0.6064, Val Acc: 0.7419
INFO:train:Early stopping triggered after 31 epochs
INFO:train:Epoch 32/100 	Train Loss: 0.3210, Train Acc: 1.0000	 Val Loss: 0.6311, Val Acc: 0.7097
INFO:train:Early stopping triggered after 32 epochs
INFO:train:Epoch 33/100 	Train Loss: 0.3151, Train Acc: 1.0000	 Val Loss: 0.6331, Val Acc: 0.7097
INFO:train:Early stopping triggered after 33 epochs
INFO:train:Epoch 34/100 	Train Loss: 0.3255, Train Acc: 1.0000	 Val Loss: 0.6169, Val Acc: 0.7097
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 0.3152, Train Acc: 1.0000	 Val Loss: 0.6104, Val Acc: 0.7097
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 0.3131, Train Acc: 1.0000	 Val Loss: 0.6045, Val Acc: 0.7742
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 0.3134, Train Acc: 1.0000	 Val Loss: 0.6328, Val Acc: 0.7742
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 0.3123, Train Acc: 1.0000	 Val Loss: 0.6247, Val Acc: 0.7742
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 0.3135, Train Acc: 1.0000	 Val Loss: 0.6581, Val Acc: 0.7742
INFO:train:Early stopping triggered after 39 epochs
INFO:train:Epoch 40/100 	Train Loss: 0.3172, Train Acc: 1.0000	 Val Loss: 0.6268, Val Acc: 0.7742
INFO:train:Early stopping triggered after 40 epochs
INFO:train:Epoch 41/100 	Train Loss: 0.3101, Train Acc: 1.0000	 Val Loss: 0.6123, Val Acc: 0.7742
INFO:train:Early stopping triggered after 41 epochs
INFO:train:Epoch 42/100 	Train Loss: 0.3078, Train Acc: 1.0000	 Val Loss: 0.6199, Val Acc: 0.7742
INFO:train:Early stopping triggered after 42 epochs
INFO:train:Epoch 43/100 	Train Loss: 0.3168, Train Acc: 1.0000	 Val Loss: 0.6232, Val Acc: 0.7742
INFO:train:Early stopping triggered after 43 epochs
INFO:train:Epoch 44/100 	Train Loss: 0.3129, Train Acc: 1.0000	 Val Loss: 0.6370, Val Acc: 0.7742
INFO:train:Early stopping triggered after 44 epochs
INFO:train:Epoch 45/100 	Train Loss: 0.3146, Train Acc: 1.0000	 Val Loss: 0.6552, Val Acc: 0.7742
INFO:train:Early stopping triggered after 45 epochs
INFO:train:Epoch 46/100 	Train Loss: 0.3125, Train Acc: 1.0000	 Val Loss: 0.6400, Val Acc: 0.7742
INFO:train:Early stopping triggered after 46 epochs
INFO:train:Epoch 47/100 	Train Loss: 0.3171, Train Acc: 1.0000	 Val Loss: 0.6131, Val Acc: 0.7742
INFO:train:Early stopping triggered after 47 epochs
INFO:train:Epoch 48/100 	Train Loss: 0.3122, Train Acc: 1.0000	 Val Loss: 0.6067, Val Acc: 0.7742
INFO:train:Early stopping triggered after 48 epochs
INFO:train:Epoch 49/100 	Train Loss: 0.3155, Train Acc: 1.0000	 Val Loss: 0.6096, Val Acc: 0.8065
INFO:train:Early stopping triggered after 49 epochs
INFO:train:Epoch 50/100 	Train Loss: 0.3094, Train Acc: 1.0000	 Val Loss: 0.6417, Val Acc: 0.7742
INFO:train:Early stopping triggered after 50 epochs
INFO:train:Epoch 51/100 	Train Loss: 0.3144, Train Acc: 1.0000	 Val Loss: 0.6676, Val Acc: 0.7742
INFO:train:Early stopping triggered after 51 epochs
INFO:train:Epoch 52/100 	Train Loss: 0.3083, Train Acc: 1.0000	 Val Loss: 0.6477, Val Acc: 0.7742
INFO:train:Early stopping triggered after 52 epochs
INFO:train:Epoch 53/100 	Train Loss: 0.3098, Train Acc: 1.0000	 Val Loss: 0.6102, Val Acc: 0.8065
INFO:train:Early stopping triggered after 53 epochs
INFO:train:Epoch 54/100 	Train Loss: 0.3101, Train Acc: 1.0000	 Val Loss: 0.5882, Val Acc: 0.8065
INFO:train:Early stopping triggered after 54 epochs
INFO:train:Epoch 55/100 	Train Loss: 0.3134, Train Acc: 1.0000	 Val Loss: 0.5863, Val Acc: 0.8065
INFO:train:Early stopping triggered after 55 epochs
INFO:train:Epoch 56/100 	Train Loss: 0.3129, Train Acc: 1.0000	 Val Loss: 0.6056, Val Acc: 0.7742
INFO:train:Early stopping triggered after 56 epochs
INFO:train:Epoch 57/100 	Train Loss: 0.3153, Train Acc: 1.0000	 Val Loss: 0.6532, Val Acc: 0.7742
INFO:train:Early stopping triggered after 57 epochs
INFO:train:Epoch 58/100 	Train Loss: 0.3113, Train Acc: 1.0000	 Val Loss: 0.6459, Val Acc: 0.7742
INFO:train:Early stopping triggered after 58 epochs
INFO:train:Epoch 59/100 	Train Loss: 0.3104, Train Acc: 1.0000	 Val Loss: 0.6367, Val Acc: 0.7742
INFO:train:Early stopping triggered after 59 epochs
INFO:train:Epoch 60/100 	Train Loss: 0.3116, Train Acc: 1.0000	 Val Loss: 0.5952, Val Acc: 0.8065
INFO:train:Early stopping triggered after 60 epochs
INFO:train:Epoch 61/100 	Train Loss: 0.3094, Train Acc: 1.0000	 Val Loss: 0.5965, Val Acc: 0.7742
INFO:train:Early stopping triggered after 61 epochs
INFO:train:Epoch 62/100 	Train Loss: 0.3062, Train Acc: 1.0000	 Val Loss: 0.5936, Val Acc: 0.7419
INFO:train:Early stopping triggered after 62 epochs
INFO:train:Epoch 63/100 	Train Loss: 0.3083, Train Acc: 1.0000	 Val Loss: 0.6231, Val Acc: 0.7419
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.3121, Train Acc: 1.0000	 Val Loss: 0.6389, Val Acc: 0.7419
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.3105, Train Acc: 1.0000	 Val Loss: 0.6384, Val Acc: 0.7419
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.3037, Train Acc: 1.0000	 Val Loss: 0.6222, Val Acc: 0.7419
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.3085, Train Acc: 1.0000	 Val Loss: 0.6073, Val Acc: 0.7419
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.3048, Train Acc: 1.0000	 Val Loss: 0.6113, Val Acc: 0.7419
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.3056, Train Acc: 1.0000	 Val Loss: 0.6141, Val Acc: 0.7419
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.3069, Train Acc: 1.0000	 Val Loss: 0.6358, Val Acc: 0.7419
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.3090, Train Acc: 1.0000	 Val Loss: 0.6566, Val Acc: 0.7419
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.3090, Train Acc: 1.0000	 Val Loss: 0.6469, Val Acc: 0.7419
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.3051, Train Acc: 1.0000	 Val Loss: 0.6282, Val Acc: 0.7419
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.3053, Train Acc: 1.0000	 Val Loss: 0.6346, Val Acc: 0.7419
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.3065, Train Acc: 1.0000	 Val Loss: 0.6414, Val Acc: 0.7419
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.3039, Train Acc: 1.0000	 Val Loss: 0.6387, Val Acc: 0.7419
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.3054, Train Acc: 1.0000	 Val Loss: 0.6200, Val Acc: 0.7742
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.3073, Train Acc: 1.0000	 Val Loss: 0.6220, Val Acc: 0.7419
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.3038, Train Acc: 1.0000	 Val Loss: 0.6110, Val Acc: 0.7742
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.3051, Train Acc: 1.0000	 Val Loss: 0.6092, Val Acc: 0.7742
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.3042, Train Acc: 1.0000	 Val Loss: 0.6131, Val Acc: 0.7742
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.3044, Train Acc: 1.0000	 Val Loss: 0.6252, Val Acc: 0.7419
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.3068, Train Acc: 1.0000	 Val Loss: 0.6336, Val Acc: 0.7419
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.3055, Train Acc: 1.0000	 Val Loss: 0.6529, Val Acc: 0.7419
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.3060, Train Acc: 1.0000	 Val Loss: 0.6796, Val Acc: 0.7419
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.3061, Train Acc: 1.0000	 Val Loss: 0.6492, Val Acc: 0.7419
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.3056, Train Acc: 1.0000	 Val Loss: 0.6294, Val Acc: 0.7097
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.3045, Train Acc: 1.0000	 Val Loss: 0.6150, Val Acc: 0.7097
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.3040, Train Acc: 1.0000	 Val Loss: 0.6052, Val Acc: 0.7419
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.3063, Train Acc: 1.0000	 Val Loss: 0.6158, Val Acc: 0.7097
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.3048, Train Acc: 1.0000	 Val Loss: 0.6219, Val Acc: 0.7097
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.3055, Train Acc: 1.0000	 Val Loss: 0.6286, Val Acc: 0.7419
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.3037, Train Acc: 1.0000	 Val Loss: 0.6363, Val Acc: 0.7097
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.3036, Train Acc: 1.0000	 Val Loss: 0.6122, Val Acc: 0.7419
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.3052, Train Acc: 1.0000	 Val Loss: 0.6143, Val Acc: 0.7419
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.3036, Train Acc: 1.0000	 Val Loss: 0.6117, Val Acc: 0.7419
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.3020, Train Acc: 1.0000	 Val Loss: 0.6190, Val Acc: 0.7097
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.3060, Train Acc: 1.0000	 Val Loss: 0.6202, Val Acc: 0.7097
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.3021, Train Acc: 1.0000	 Val Loss: 0.6221, Val Acc: 0.7097
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.3021, Train Acc: 1.0000	 Val Loss: 0.6083, Val Acc: 0.7097
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 27.37s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 58 / 58 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.28s
INFO:train:validation got 22 / 31 correct, accuracy: 0.7096774193548387
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.09s
INFO:__main__:model: Transformer(
  (encoder): Encoder(
    (layers): ModuleList(
      (0-3): 4 x EncoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (decoder): Decoder(
    (layers): ModuleList(
      (0-3): 4 x DecoderLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=1023, out_features=1023, bias=True)
          (key): Linear(in_features=1023, out_features=1023, bias=True)
          (value): Linear(in_features=1023, out_features=1023, bias=True)
          (fc_out): Linear(in_features=1023, out_features=1023, bias=True)
        )
        (feed_forward): FeedForward(
          (fc1): Linear(in_features=1023, out_features=128, bias=True)
          (fc2): Linear(in_features=128, out_features=1023, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
        )
        (norm1): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((1023,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.2, inplace=False)
        (dropout2): Dropout(p=0.2, inplace=False)
        (dropout3): Dropout(p=0.2, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=1023, out_features=2, bias=True)
)
INFO:__main__:Training the network
INFO:train:Epoch 1/100 	Train Loss: 0.3240, Train Acc: 0.9535	 Val Loss: 0.2524, Val Acc: 1.0000
INFO:train:Epoch 2/100 	Train Loss: 0.2345, Train Acc: 0.9884	 Val Loss: 0.2314, Val Acc: 1.0000
INFO:train:Epoch 3/100 	Train Loss: 0.2248, Train Acc: 1.0000	 Val Loss: 0.2403, Val Acc: 1.0000
INFO:train:Epoch 4/100 	Train Loss: 0.2324, Train Acc: 1.0000	 Val Loss: 0.2398, Val Acc: 1.0000
INFO:train:Epoch 5/100 	Train Loss: 0.2243, Train Acc: 1.0000	 Val Loss: 0.2288, Val Acc: 1.0000
INFO:train:Epoch 6/100 	Train Loss: 0.2190, Train Acc: 1.0000	 Val Loss: 0.2232, Val Acc: 1.0000
INFO:train:Epoch 7/100 	Train Loss: 0.2173, Train Acc: 1.0000	 Val Loss: 0.2238, Val Acc: 1.0000
INFO:train:Epoch 8/100 	Train Loss: 0.2122, Train Acc: 1.0000	 Val Loss: 0.2202, Val Acc: 1.0000
INFO:train:Epoch 9/100 	Train Loss: 0.2120, Train Acc: 1.0000	 Val Loss: 0.2203, Val Acc: 1.0000
INFO:train:Epoch 10/100 	Train Loss: 0.2120, Train Acc: 1.0000	 Val Loss: 0.2218, Val Acc: 1.0000
INFO:train:Epoch 11/100 	Train Loss: 0.2111, Train Acc: 1.0000	 Val Loss: 0.2222, Val Acc: 1.0000
INFO:train:Early stopping triggered after 11 epochs
INFO:train:Epoch 12/100 	Train Loss: 0.2097, Train Acc: 1.0000	 Val Loss: 0.2254, Val Acc: 1.0000
INFO:train:Early stopping triggered after 12 epochs
INFO:train:Epoch 13/100 	Train Loss: 0.2097, Train Acc: 1.0000	 Val Loss: 0.2270, Val Acc: 1.0000
INFO:train:Early stopping triggered after 13 epochs
INFO:train:Epoch 14/100 	Train Loss: 0.2099, Train Acc: 1.0000	 Val Loss: 0.2236, Val Acc: 1.0000
INFO:train:Early stopping triggered after 14 epochs
INFO:train:Epoch 15/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2201, Val Acc: 1.0000
INFO:train:Early stopping triggered after 15 epochs
INFO:train:Epoch 16/100 	Train Loss: 0.2106, Train Acc: 1.0000	 Val Loss: 0.2234, Val Acc: 1.0000
INFO:train:Early stopping triggered after 16 epochs
INFO:train:Epoch 17/100 	Train Loss: 0.2104, Train Acc: 1.0000	 Val Loss: 0.2214, Val Acc: 1.0000
INFO:train:Early stopping triggered after 17 epochs
INFO:train:Epoch 18/100 	Train Loss: 0.2127, Train Acc: 1.0000	 Val Loss: 0.2155, Val Acc: 1.0000
INFO:train:Early stopping triggered after 18 epochs
INFO:train:Epoch 19/100 	Train Loss: 0.2081, Train Acc: 1.0000	 Val Loss: 0.2161, Val Acc: 1.0000
INFO:train:Early stopping triggered after 19 epochs
INFO:train:Epoch 20/100 	Train Loss: 0.2066, Train Acc: 1.0000	 Val Loss: 0.2156, Val Acc: 1.0000
INFO:train:Early stopping triggered after 20 epochs
INFO:train:Epoch 21/100 	Train Loss: 0.2098, Train Acc: 1.0000	 Val Loss: 0.2136, Val Acc: 1.0000
INFO:train:Early stopping triggered after 21 epochs
INFO:train:Epoch 22/100 	Train Loss: 0.2070, Train Acc: 1.0000	 Val Loss: 0.2140, Val Acc: 1.0000
INFO:train:Early stopping triggered after 22 epochs
INFO:train:Epoch 23/100 	Train Loss: 0.2107, Train Acc: 1.0000	 Val Loss: 0.2153, Val Acc: 1.0000
INFO:train:Early stopping triggered after 23 epochs
INFO:train:Epoch 24/100 	Train Loss: 0.2073, Train Acc: 1.0000	 Val Loss: 0.2159, Val Acc: 1.0000
INFO:train:Early stopping triggered after 24 epochs
INFO:train:Epoch 25/100 	Train Loss: 0.2052, Train Acc: 1.0000	 Val Loss: 0.2176, Val Acc: 1.0000
INFO:train:Early stopping triggered after 25 epochs
INFO:train:Epoch 26/100 	Train Loss: 0.2080, Train Acc: 1.0000	 Val Loss: 0.2186, Val Acc: 1.0000
INFO:train:Early stopping triggered after 26 epochs
INFO:train:Epoch 27/100 	Train Loss: 0.2085, Train Acc: 1.0000	 Val Loss: 0.2157, Val Acc: 1.0000
INFO:train:Early stopping triggered after 27 epochs
INFO:train:Epoch 28/100 	Train Loss: 0.2039, Train Acc: 1.0000	 Val Loss: 0.2139, Val Acc: 1.0000
INFO:train:Early stopping triggered after 28 epochs
INFO:train:Epoch 29/100 	Train Loss: 0.2069, Train Acc: 1.0000	 Val Loss: 0.2145, Val Acc: 1.0000
INFO:train:Early stopping triggered after 29 epochs
INFO:train:Epoch 30/100 	Train Loss: 0.2054, Train Acc: 1.0000	 Val Loss: 0.2159, Val Acc: 1.0000
INFO:train:Early stopping triggered after 30 epochs
INFO:train:Epoch 31/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2149, Val Acc: 1.0000
INFO:train:Early stopping triggered after 31 epochs
INFO:train:Epoch 32/100 	Train Loss: 0.2074, Train Acc: 1.0000	 Val Loss: 0.2136, Val Acc: 1.0000
INFO:train:Early stopping triggered after 32 epochs
INFO:train:Epoch 33/100 	Train Loss: 0.2039, Train Acc: 1.0000	 Val Loss: 0.2177, Val Acc: 1.0000
INFO:train:Early stopping triggered after 33 epochs
INFO:train:Epoch 34/100 	Train Loss: 0.2066, Train Acc: 1.0000	 Val Loss: 0.2156, Val Acc: 1.0000
INFO:train:Early stopping triggered after 34 epochs
INFO:train:Epoch 35/100 	Train Loss: 0.2063, Train Acc: 1.0000	 Val Loss: 0.2169, Val Acc: 1.0000
INFO:train:Early stopping triggered after 35 epochs
INFO:train:Epoch 36/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2174, Val Acc: 1.0000
INFO:train:Early stopping triggered after 36 epochs
INFO:train:Epoch 37/100 	Train Loss: 0.2064, Train Acc: 1.0000	 Val Loss: 0.2188, Val Acc: 1.0000
INFO:train:Early stopping triggered after 37 epochs
INFO:train:Epoch 38/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2152, Val Acc: 1.0000
INFO:train:Early stopping triggered after 38 epochs
INFO:train:Epoch 39/100 	Train Loss: 0.2075, Train Acc: 1.0000	 Val Loss: 0.2134, Val Acc: 1.0000
INFO:train:Early stopping triggered after 39 epochs
INFO:train:Epoch 40/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2155, Val Acc: 1.0000
INFO:train:Early stopping triggered after 40 epochs
INFO:train:Epoch 41/100 	Train Loss: 0.2093, Train Acc: 1.0000	 Val Loss: 0.2158, Val Acc: 1.0000
INFO:train:Early stopping triggered after 41 epochs
INFO:train:Epoch 42/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2159, Val Acc: 1.0000
INFO:train:Early stopping triggered after 42 epochs
INFO:train:Epoch 43/100 	Train Loss: 0.2052, Train Acc: 1.0000	 Val Loss: 0.2210, Val Acc: 1.0000
INFO:train:Early stopping triggered after 43 epochs
INFO:train:Epoch 44/100 	Train Loss: 0.2057, Train Acc: 1.0000	 Val Loss: 0.2172, Val Acc: 1.0000
INFO:train:Early stopping triggered after 44 epochs
INFO:train:Epoch 45/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2145, Val Acc: 1.0000
INFO:train:Early stopping triggered after 45 epochs
INFO:train:Epoch 46/100 	Train Loss: 0.2045, Train Acc: 1.0000	 Val Loss: 0.2142, Val Acc: 1.0000
INFO:train:Early stopping triggered after 46 epochs
INFO:train:Epoch 47/100 	Train Loss: 0.2062, Train Acc: 1.0000	 Val Loss: 0.2129, Val Acc: 1.0000
INFO:train:Early stopping triggered after 47 epochs
INFO:train:Epoch 48/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2157, Val Acc: 1.0000
INFO:train:Early stopping triggered after 48 epochs
INFO:train:Epoch 49/100 	Train Loss: 0.2039, Train Acc: 1.0000	 Val Loss: 0.2162, Val Acc: 1.0000
INFO:train:Early stopping triggered after 49 epochs
INFO:train:Epoch 50/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2124, Val Acc: 1.0000
INFO:train:Early stopping triggered after 50 epochs
INFO:train:Epoch 51/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2128, Val Acc: 1.0000
INFO:train:Early stopping triggered after 51 epochs
INFO:train:Epoch 52/100 	Train Loss: 0.2071, Train Acc: 1.0000	 Val Loss: 0.2126, Val Acc: 1.0000
INFO:train:Early stopping triggered after 52 epochs
INFO:train:Epoch 53/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2114, Val Acc: 1.0000
INFO:train:Early stopping triggered after 53 epochs
INFO:train:Epoch 54/100 	Train Loss: 0.2049, Train Acc: 1.0000	 Val Loss: 0.2147, Val Acc: 1.0000
INFO:train:Early stopping triggered after 54 epochs
INFO:train:Epoch 55/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2144, Val Acc: 1.0000
INFO:train:Early stopping triggered after 55 epochs
INFO:train:Epoch 56/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2126, Val Acc: 1.0000
INFO:train:Early stopping triggered after 56 epochs
INFO:train:Epoch 57/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2139, Val Acc: 1.0000
INFO:train:Early stopping triggered after 57 epochs
INFO:train:Epoch 58/100 	Train Loss: 0.2059, Train Acc: 1.0000	 Val Loss: 0.2156, Val Acc: 1.0000
INFO:train:Early stopping triggered after 58 epochs
INFO:train:Epoch 59/100 	Train Loss: 0.2052, Train Acc: 1.0000	 Val Loss: 0.2129, Val Acc: 1.0000
INFO:train:Early stopping triggered after 59 epochs
INFO:train:Epoch 60/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2130, Val Acc: 1.0000
INFO:train:Early stopping triggered after 60 epochs
INFO:train:Epoch 61/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2130, Val Acc: 1.0000
INFO:train:Early stopping triggered after 61 epochs
INFO:train:Epoch 62/100 	Train Loss: 0.2048, Train Acc: 1.0000	 Val Loss: 0.2120, Val Acc: 1.0000
INFO:train:Early stopping triggered after 62 epochs
INFO:train:Epoch 63/100 	Train Loss: 0.2041, Train Acc: 1.0000	 Val Loss: 0.2131, Val Acc: 1.0000
INFO:train:Early stopping triggered after 63 epochs
INFO:train:Epoch 64/100 	Train Loss: 0.2034, Train Acc: 1.0000	 Val Loss: 0.2133, Val Acc: 1.0000
INFO:train:Early stopping triggered after 64 epochs
INFO:train:Epoch 65/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2135, Val Acc: 1.0000
INFO:train:Early stopping triggered after 65 epochs
INFO:train:Epoch 66/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2150, Val Acc: 1.0000
INFO:train:Early stopping triggered after 66 epochs
INFO:train:Epoch 67/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2137, Val Acc: 1.0000
INFO:train:Early stopping triggered after 67 epochs
INFO:train:Epoch 68/100 	Train Loss: 0.2070, Train Acc: 1.0000	 Val Loss: 0.2140, Val Acc: 1.0000
INFO:train:Early stopping triggered after 68 epochs
INFO:train:Epoch 69/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2176, Val Acc: 1.0000
INFO:train:Early stopping triggered after 69 epochs
INFO:train:Epoch 70/100 	Train Loss: 0.2079, Train Acc: 1.0000	 Val Loss: 0.2163, Val Acc: 1.0000
INFO:train:Early stopping triggered after 70 epochs
INFO:train:Epoch 71/100 	Train Loss: 0.2076, Train Acc: 1.0000	 Val Loss: 0.2130, Val Acc: 1.0000
INFO:train:Early stopping triggered after 71 epochs
INFO:train:Epoch 72/100 	Train Loss: 0.2055, Train Acc: 1.0000	 Val Loss: 0.2151, Val Acc: 1.0000
INFO:train:Early stopping triggered after 72 epochs
INFO:train:Epoch 73/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2146, Val Acc: 1.0000
INFO:train:Early stopping triggered after 73 epochs
INFO:train:Epoch 74/100 	Train Loss: 0.2061, Train Acc: 1.0000	 Val Loss: 0.2124, Val Acc: 1.0000
INFO:train:Early stopping triggered after 74 epochs
INFO:train:Epoch 75/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2177, Val Acc: 1.0000
INFO:train:Early stopping triggered after 75 epochs
INFO:train:Epoch 76/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2177, Val Acc: 1.0000
INFO:train:Early stopping triggered after 76 epochs
INFO:train:Epoch 77/100 	Train Loss: 0.2059, Train Acc: 1.0000	 Val Loss: 0.2145, Val Acc: 1.0000
INFO:train:Early stopping triggered after 77 epochs
INFO:train:Epoch 78/100 	Train Loss: 0.2036, Train Acc: 1.0000	 Val Loss: 0.2162, Val Acc: 1.0000
INFO:train:Early stopping triggered after 78 epochs
INFO:train:Epoch 79/100 	Train Loss: 0.2081, Train Acc: 1.0000	 Val Loss: 0.2146, Val Acc: 1.0000
INFO:train:Early stopping triggered after 79 epochs
INFO:train:Epoch 80/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2126, Val Acc: 1.0000
INFO:train:Early stopping triggered after 80 epochs
INFO:train:Epoch 81/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2186, Val Acc: 1.0000
INFO:train:Early stopping triggered after 81 epochs
INFO:train:Epoch 82/100 	Train Loss: 0.2058, Train Acc: 1.0000	 Val Loss: 0.2151, Val Acc: 1.0000
INFO:train:Early stopping triggered after 82 epochs
INFO:train:Epoch 83/100 	Train Loss: 0.2049, Train Acc: 1.0000	 Val Loss: 0.2128, Val Acc: 1.0000
INFO:train:Early stopping triggered after 83 epochs
INFO:train:Epoch 84/100 	Train Loss: 0.2042, Train Acc: 1.0000	 Val Loss: 0.2136, Val Acc: 1.0000
INFO:train:Early stopping triggered after 84 epochs
INFO:train:Epoch 85/100 	Train Loss: 0.2078, Train Acc: 1.0000	 Val Loss: 0.2119, Val Acc: 1.0000
INFO:train:Early stopping triggered after 85 epochs
INFO:train:Epoch 86/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2146, Val Acc: 1.0000
INFO:train:Early stopping triggered after 86 epochs
INFO:train:Epoch 87/100 	Train Loss: 0.2051, Train Acc: 1.0000	 Val Loss: 0.2124, Val Acc: 1.0000
INFO:train:Early stopping triggered after 87 epochs
INFO:train:Epoch 88/100 	Train Loss: 0.2060, Train Acc: 1.0000	 Val Loss: 0.2117, Val Acc: 1.0000
INFO:train:Early stopping triggered after 88 epochs
INFO:train:Epoch 89/100 	Train Loss: 0.2052, Train Acc: 1.0000	 Val Loss: 0.2117, Val Acc: 1.0000
INFO:train:Early stopping triggered after 89 epochs
INFO:train:Epoch 90/100 	Train Loss: 0.2082, Train Acc: 1.0000	 Val Loss: 0.2107, Val Acc: 1.0000
INFO:train:Early stopping triggered after 90 epochs
INFO:train:Epoch 91/100 	Train Loss: 0.2081, Train Acc: 1.0000	 Val Loss: 0.2123, Val Acc: 1.0000
INFO:train:Early stopping triggered after 91 epochs
INFO:train:Epoch 92/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2165, Val Acc: 1.0000
INFO:train:Early stopping triggered after 92 epochs
INFO:train:Epoch 93/100 	Train Loss: 0.2072, Train Acc: 1.0000	 Val Loss: 0.2141, Val Acc: 1.0000
INFO:train:Early stopping triggered after 93 epochs
INFO:train:Epoch 94/100 	Train Loss: 0.2036, Train Acc: 1.0000	 Val Loss: 0.2130, Val Acc: 1.0000
INFO:train:Early stopping triggered after 94 epochs
INFO:train:Epoch 95/100 	Train Loss: 0.2044, Train Acc: 1.0000	 Val Loss: 0.2131, Val Acc: 1.0000
INFO:train:Early stopping triggered after 95 epochs
INFO:train:Epoch 96/100 	Train Loss: 0.2050, Train Acc: 1.0000	 Val Loss: 0.2133, Val Acc: 1.0000
INFO:train:Early stopping triggered after 96 epochs
INFO:train:Epoch 97/100 	Train Loss: 0.2035, Train Acc: 1.0000	 Val Loss: 0.2126, Val Acc: 1.0000
INFO:train:Early stopping triggered after 97 epochs
INFO:train:Epoch 98/100 	Train Loss: 0.2046, Train Acc: 1.0000	 Val Loss: 0.2142, Val Acc: 1.0000
INFO:train:Early stopping triggered after 98 epochs
INFO:train:Epoch 99/100 	Train Loss: 0.2063, Train Acc: 1.0000	 Val Loss: 0.2121, Val Acc: 1.0000
INFO:train:Early stopping triggered after 99 epochs
INFO:train:Epoch 100/100 	Train Loss: 0.2056, Train Acc: 1.0000	 Val Loss: 0.2115, Val Acc: 1.0000
INFO:train:Early stopping triggered after 100 epochs
INFO:plot:Saving attention map to: figures/model_accuracy.png
INFO:__main__:Total time taken to train the model: 19.83s
INFO:train:train got 64 / 64 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:train got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/train_confusion_matrix.png
INFO:train:Total time taken evaluate on train set the model: 0.24s
INFO:train:validation got 22 / 22 correct, accuracy: 1.0
INFO:plot:Saving cofusion matrix map to: figures/validation_confusion_matrix.png
INFO:train:Total time taken evaluate on validation set the model: 0.08s
