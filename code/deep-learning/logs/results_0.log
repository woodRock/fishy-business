2025-01-23 23:04:09,444 - INFO - Starting training pipeline
2025-01-23 23:04:09,444 - INFO - Starting main training phase
2025-01-23 23:04:09,444 - INFO - Loading dataset: oil
2025-01-23 23:04:09,445 - INFO - Loading data from: /home/woodj/Desktop/fishy-business/data/REIMS.xlsx
2025-01-23 23:04:15,124 - INFO - Loaded data with shape: (306, 2081)
2025-01-23 23:04:15,128 - INFO - Filtered data shape: (126, 2081)
2025-01-23 23:04:15,128 - INFO - Dataset shape after filtering: (126, 2081)
2025-01-23 23:04:15,129 - INFO - Features shape: (126, 2080), Labels shape: (126, 7)
2025-01-23 23:04:15,142 - INFO - Created model: TestTimeTransformer(
  (spectral_embedding): Sequential(
    (0): Linear(in_features=2080, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (attention_layers): ModuleList(
    (0-3): 4 x MultiHeadAttention(
      (qkv): Linear(in_features=128, out_features=384, bias=True)
      (fc_out): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (feed_forward): Sequential(
    (0): Linear(in_features=128, out_features=512, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=512, out_features=128, bias=True)
  )
  (layer_norms): ModuleList(
    (0-7): 8 x LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (dropout): Dropout(p=0.2, inplace=False)
  (fc_out): Linear(in_features=128, out_features=7, bias=True)
  (prm_encoder): Sequential(
    (0): Linear(in_features=128, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (confidence_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=128, out_features=1, bias=True)
    (5): Sigmoid()
  )
)
2025-01-23 23:04:15,304 - INFO - Evaluating test-time compute performance...
2025-01-23 23:04:15,307 - INFO - 
Processing fold 1/5
2025-01-23 23:04:15,313 - INFO - Created model: TestTimeTransformer(
  (spectral_embedding): Sequential(
    (0): Linear(in_features=2080, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (attention_layers): ModuleList(
    (0-3): 4 x MultiHeadAttention(
      (qkv): Linear(in_features=128, out_features=384, bias=True)
      (fc_out): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (feed_forward): Sequential(
    (0): Linear(in_features=128, out_features=512, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=512, out_features=128, bias=True)
  )
  (layer_norms): ModuleList(
    (0-7): 8 x LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (dropout): Dropout(p=0.2, inplace=False)
  (fc_out): Linear(in_features=128, out_features=7, bias=True)
  (prm_encoder): Sequential(
    (0): Linear(in_features=128, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (confidence_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=128, out_features=1, bias=True)
    (5): Sigmoid()
  )
)
2025-01-23 23:04:19,431 - INFO - Training base model for fold 1
2025-01-23 23:04:19,431 - INFO - Training model with single train/val split (80/20)
2025-01-23 23:04:19,433 - INFO - Training set size: 66
2025-01-23 23:04:19,433 - INFO - Validation set size: 34
2025-01-23 23:04:19,598 - INFO - Epoch 1: New best validation accuracy: 0.1429
2025-01-23 23:04:19,633 - INFO - Epoch 2: New best validation accuracy: 0.2571
2025-01-23 23:04:19,726 - INFO - Epoch 5
2025-01-23 23:04:19,726 - INFO - Train Loss: 2.1422
2025-01-23 23:04:19,726 - INFO - Val Loss: 2.0683
2025-01-23 23:04:19,726 - INFO - Current Val Accuracy: 0.1429
2025-01-23 23:04:19,726 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:04:19,881 - INFO - Epoch 10
2025-01-23 23:04:19,881 - INFO - Train Loss: 1.8636
2025-01-23 23:04:19,881 - INFO - Val Loss: 1.9813
2025-01-23 23:04:19,881 - INFO - Current Val Accuracy: 0.0643
2025-01-23 23:04:19,881 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:04:19,943 - INFO - Early stopping triggered after 12 epochs
2025-01-23 23:04:19,943 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:19,974 - INFO - Early stopping triggered after 13 epochs
2025-01-23 23:04:19,975 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,008 - INFO - Early stopping triggered after 14 epochs
2025-01-23 23:04:20,008 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,044 - INFO - Early stopping triggered after 15 epochs
2025-01-23 23:04:20,044 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,044 - INFO - Epoch 15
2025-01-23 23:04:20,044 - INFO - Train Loss: 1.7604
2025-01-23 23:04:20,044 - INFO - Val Loss: 1.8924
2025-01-23 23:04:20,044 - INFO - Current Val Accuracy: 0.2286
2025-01-23 23:04:20,044 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:04:20,080 - INFO - Early stopping triggered after 16 epochs
2025-01-23 23:04:20,081 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,111 - INFO - Early stopping triggered after 17 epochs
2025-01-23 23:04:20,111 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,142 - INFO - Early stopping triggered after 18 epochs
2025-01-23 23:04:20,142 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,172 - INFO - Early stopping triggered after 19 epochs
2025-01-23 23:04:20,172 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,203 - INFO - Early stopping triggered after 20 epochs
2025-01-23 23:04:20,203 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,203 - INFO - Epoch 20
2025-01-23 23:04:20,203 - INFO - Train Loss: 1.6921
2025-01-23 23:04:20,203 - INFO - Val Loss: 2.0235
2025-01-23 23:04:20,203 - INFO - Current Val Accuracy: 0.2000
2025-01-23 23:04:20,203 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:04:20,234 - INFO - Early stopping triggered after 21 epochs
2025-01-23 23:04:20,235 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,265 - INFO - Early stopping triggered after 22 epochs
2025-01-23 23:04:20,265 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,295 - INFO - Early stopping triggered after 23 epochs
2025-01-23 23:04:20,295 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,325 - INFO - Early stopping triggered after 24 epochs
2025-01-23 23:04:20,325 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,355 - INFO - Early stopping triggered after 25 epochs
2025-01-23 23:04:20,356 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,356 - INFO - Epoch 25
2025-01-23 23:04:20,356 - INFO - Train Loss: 1.6107
2025-01-23 23:04:20,356 - INFO - Val Loss: 1.9893
2025-01-23 23:04:20,356 - INFO - Current Val Accuracy: 0.2000
2025-01-23 23:04:20,356 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:04:20,386 - INFO - Early stopping triggered after 26 epochs
2025-01-23 23:04:20,386 - INFO - Best validation accuracy: 0.2571
2025-01-23 23:04:20,420 - INFO - Epoch 27: New best validation accuracy: 0.3143
2025-01-23 23:04:20,511 - INFO - Epoch 30
2025-01-23 23:04:20,511 - INFO - Train Loss: 1.5939
2025-01-23 23:04:20,511 - INFO - Val Loss: 1.8987
2025-01-23 23:04:20,511 - INFO - Current Val Accuracy: 0.2000
2025-01-23 23:04:20,512 - INFO - Best Val Accuracy: 0.3143
2025-01-23 23:04:20,665 - INFO - Epoch 35
2025-01-23 23:04:20,665 - INFO - Train Loss: 1.5181
2025-01-23 23:04:20,665 - INFO - Val Loss: 1.9685
2025-01-23 23:04:20,665 - INFO - Current Val Accuracy: 0.3143
2025-01-23 23:04:20,665 - INFO - Best Val Accuracy: 0.3143
2025-01-23 23:04:20,699 - INFO - Epoch 36: New best validation accuracy: 0.3429
2025-01-23 23:04:20,822 - INFO - Epoch 40
2025-01-23 23:04:20,822 - INFO - Train Loss: 1.4306
2025-01-23 23:04:20,822 - INFO - Val Loss: 2.0366
2025-01-23 23:04:20,822 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:04:20,822 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:20,976 - INFO - Epoch 45
2025-01-23 23:04:20,977 - INFO - Train Loss: 1.4167
2025-01-23 23:04:20,977 - INFO - Val Loss: 2.0624
2025-01-23 23:04:20,977 - INFO - Current Val Accuracy: 0.2000
2025-01-23 23:04:20,977 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,007 - INFO - Early stopping triggered after 46 epochs
2025-01-23 23:04:21,007 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,037 - INFO - Early stopping triggered after 47 epochs
2025-01-23 23:04:21,037 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,068 - INFO - Early stopping triggered after 48 epochs
2025-01-23 23:04:21,068 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,099 - INFO - Early stopping triggered after 49 epochs
2025-01-23 23:04:21,099 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,129 - INFO - Early stopping triggered after 50 epochs
2025-01-23 23:04:21,129 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,129 - INFO - Epoch 50
2025-01-23 23:04:21,129 - INFO - Train Loss: 1.2173
2025-01-23 23:04:21,129 - INFO - Val Loss: 2.2466
2025-01-23 23:04:21,129 - INFO - Current Val Accuracy: 0.3143
2025-01-23 23:04:21,129 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,160 - INFO - Early stopping triggered after 51 epochs
2025-01-23 23:04:21,160 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,190 - INFO - Early stopping triggered after 52 epochs
2025-01-23 23:04:21,190 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,221 - INFO - Early stopping triggered after 53 epochs
2025-01-23 23:04:21,221 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,251 - INFO - Early stopping triggered after 54 epochs
2025-01-23 23:04:21,251 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,282 - INFO - Early stopping triggered after 55 epochs
2025-01-23 23:04:21,282 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,282 - INFO - Epoch 55
2025-01-23 23:04:21,282 - INFO - Train Loss: 1.2062
2025-01-23 23:04:21,282 - INFO - Val Loss: 2.0627
2025-01-23 23:04:21,282 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:04:21,282 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,313 - INFO - Early stopping triggered after 56 epochs
2025-01-23 23:04:21,313 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,344 - INFO - Early stopping triggered after 57 epochs
2025-01-23 23:04:21,344 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,375 - INFO - Early stopping triggered after 58 epochs
2025-01-23 23:04:21,375 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,405 - INFO - Early stopping triggered after 59 epochs
2025-01-23 23:04:21,405 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,435 - INFO - Early stopping triggered after 60 epochs
2025-01-23 23:04:21,435 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,435 - INFO - Epoch 60
2025-01-23 23:04:21,435 - INFO - Train Loss: 1.1262
2025-01-23 23:04:21,435 - INFO - Val Loss: 2.2595
2025-01-23 23:04:21,435 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:04:21,435 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,466 - INFO - Early stopping triggered after 61 epochs
2025-01-23 23:04:21,467 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,498 - INFO - Early stopping triggered after 62 epochs
2025-01-23 23:04:21,498 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,529 - INFO - Early stopping triggered after 63 epochs
2025-01-23 23:04:21,529 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,560 - INFO - Early stopping triggered after 64 epochs
2025-01-23 23:04:21,560 - INFO - Best validation accuracy: 0.3429
2025-01-23 23:04:21,595 - INFO - Epoch 65: New best validation accuracy: 0.3429
2025-01-23 23:04:21,595 - INFO - Epoch 65
2025-01-23 23:04:21,595 - INFO - Train Loss: 1.0682
2025-01-23 23:04:21,595 - INFO - Val Loss: 2.1743
2025-01-23 23:04:21,595 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:04:21,595 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,748 - INFO - Epoch 70
2025-01-23 23:04:21,748 - INFO - Train Loss: 0.9696
2025-01-23 23:04:21,748 - INFO - Val Loss: 2.4493
2025-01-23 23:04:21,748 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:04:21,748 - INFO - Best Val Accuracy: 0.3429
2025-01-23 23:04:21,813 - INFO - Epoch 72: New best validation accuracy: 0.3714
2025-01-23 23:04:21,877 - INFO - Epoch 74: New best validation accuracy: 0.4286
2025-01-23 23:04:21,908 - INFO - Epoch 75
2025-01-23 23:04:21,908 - INFO - Train Loss: 0.9318
2025-01-23 23:04:21,908 - INFO - Val Loss: 2.6289
2025-01-23 23:04:21,908 - INFO - Current Val Accuracy: 0.2857
2025-01-23 23:04:21,908 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:04:22,063 - INFO - Epoch 80
2025-01-23 23:04:22,063 - INFO - Train Loss: 0.9881
2025-01-23 23:04:22,063 - INFO - Val Loss: 3.0915
2025-01-23 23:04:22,063 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:04:22,063 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:04:22,184 - INFO - Early stopping triggered after 84 epochs
2025-01-23 23:04:22,184 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,216 - INFO - Early stopping triggered after 85 epochs
2025-01-23 23:04:22,216 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,216 - INFO - Epoch 85
2025-01-23 23:04:22,217 - INFO - Train Loss: 0.9554
2025-01-23 23:04:22,217 - INFO - Val Loss: 2.6296
2025-01-23 23:04:22,217 - INFO - Current Val Accuracy: 0.3143
2025-01-23 23:04:22,217 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:04:22,247 - INFO - Early stopping triggered after 86 epochs
2025-01-23 23:04:22,247 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,277 - INFO - Early stopping triggered after 87 epochs
2025-01-23 23:04:22,277 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,307 - INFO - Early stopping triggered after 88 epochs
2025-01-23 23:04:22,308 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,338 - INFO - Early stopping triggered after 89 epochs
2025-01-23 23:04:22,338 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,368 - INFO - Early stopping triggered after 90 epochs
2025-01-23 23:04:22,369 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,369 - INFO - Epoch 90
2025-01-23 23:04:22,369 - INFO - Train Loss: 1.0140
2025-01-23 23:04:22,369 - INFO - Val Loss: 2.6113
2025-01-23 23:04:22,369 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:04:22,369 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:04:22,399 - INFO - Early stopping triggered after 91 epochs
2025-01-23 23:04:22,400 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,430 - INFO - Early stopping triggered after 92 epochs
2025-01-23 23:04:22,430 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,461 - INFO - Early stopping triggered after 93 epochs
2025-01-23 23:04:22,461 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,493 - INFO - Early stopping triggered after 94 epochs
2025-01-23 23:04:22,493 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,523 - INFO - Early stopping triggered after 95 epochs
2025-01-23 23:04:22,523 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,523 - INFO - Epoch 95
2025-01-23 23:04:22,524 - INFO - Train Loss: 0.8197
2025-01-23 23:04:22,524 - INFO - Val Loss: 2.7203
2025-01-23 23:04:22,524 - INFO - Current Val Accuracy: 0.3143
2025-01-23 23:04:22,524 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:04:22,554 - INFO - Early stopping triggered after 96 epochs
2025-01-23 23:04:22,554 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,585 - INFO - Early stopping triggered after 97 epochs
2025-01-23 23:04:22,585 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,616 - INFO - Early stopping triggered after 98 epochs
2025-01-23 23:04:22,616 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,646 - INFO - Early stopping triggered after 99 epochs
2025-01-23 23:04:22,646 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,677 - INFO - Early stopping triggered after 100 epochs
2025-01-23 23:04:22,677 - INFO - Best validation accuracy: 0.4286
2025-01-23 23:04:22,677 - INFO - Epoch 100
2025-01-23 23:04:22,677 - INFO - Train Loss: 0.7568
2025-01-23 23:04:22,677 - INFO - Val Loss: 2.6541
2025-01-23 23:04:22,677 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:04:22,677 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:07:48,231 - INFO - 
Fold 1/5 results:
2025-01-23 23:07:48,231 - INFO - Standard model metrics:
2025-01-23 23:07:48,231 - INFO - accuracy: 0.3846
2025-01-23 23:07:48,231 - INFO - precision: 0.4143
2025-01-23 23:07:48,231 - INFO - recall: 0.3929
2025-01-23 23:07:48,231 - INFO - f1: 0.3881
2025-01-23 23:07:48,231 - INFO - 
Test-time compute metrics (beam search):
2025-01-23 23:07:48,231 - INFO - accuracy: 0.3846
2025-01-23 23:07:48,231 - INFO - precision: 0.4845
2025-01-23 23:07:48,231 - INFO - recall: 0.3690
2025-01-23 23:07:48,231 - INFO - f1: 0.3736
2025-01-23 23:07:48,231 - INFO - 
Test-time compute metrics (genetic programming):
2025-01-23 23:07:48,231 - INFO - accuracy: 0.3077
2025-01-23 23:07:48,231 - INFO - precision: 0.3155
2025-01-23 23:07:48,231 - INFO - recall: 0.2857
2025-01-23 23:07:48,231 - INFO - f1: 0.2571
2025-01-23 23:07:48,231 - INFO - 
Test-time compute metrics (monte carlo rollout):
2025-01-23 23:07:48,231 - INFO - accuracy: 0.3846
2025-01-23 23:07:48,231 - INFO - precision: 0.3905
2025-01-23 23:07:48,231 - INFO - recall: 0.3810
2025-01-23 23:07:48,231 - INFO - f1: 0.3778
2025-01-23 23:07:48,231 - INFO - 
Processing fold 2/5
2025-01-23 23:07:48,238 - INFO - Created model: TestTimeTransformer(
  (spectral_embedding): Sequential(
    (0): Linear(in_features=2080, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (attention_layers): ModuleList(
    (0-3): 4 x MultiHeadAttention(
      (qkv): Linear(in_features=128, out_features=384, bias=True)
      (fc_out): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (feed_forward): Sequential(
    (0): Linear(in_features=128, out_features=512, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=512, out_features=128, bias=True)
  )
  (layer_norms): ModuleList(
    (0-7): 8 x LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (dropout): Dropout(p=0.2, inplace=False)
  (fc_out): Linear(in_features=128, out_features=7, bias=True)
  (prm_encoder): Sequential(
    (0): Linear(in_features=128, out_features=256, bias=True)
    (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=256, out_features=128, bias=True)
    (5): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (6): GELU(approximate='none')
  )
  (confidence_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=128, out_features=1, bias=True)
    (5): Sigmoid()
  )
)
2025-01-23 23:07:48,244 - INFO - Training base model for fold 2
2025-01-23 23:07:48,244 - INFO - Training model with single train/val split (80/20)
2025-01-23 23:07:48,246 - INFO - Training set size: 67
2025-01-23 23:07:48,246 - INFO - Validation set size: 34
2025-01-23 23:07:48,287 - INFO - Epoch 1: New best validation accuracy: 0.1429
2025-01-23 23:07:48,325 - INFO - Epoch 2: New best validation accuracy: 0.1643
2025-01-23 23:07:48,378 - INFO - Epoch 3: New best validation accuracy: 0.1714
2025-01-23 23:07:48,455 - INFO - Epoch 5
2025-01-23 23:07:48,455 - INFO - Train Loss: 2.3298
2025-01-23 23:07:48,455 - INFO - Val Loss: 2.0335
2025-01-23 23:07:48,455 - INFO - Current Val Accuracy: 0.1429
2025-01-23 23:07:48,455 - INFO - Best Val Accuracy: 0.1714
2025-01-23 23:07:48,496 - INFO - Epoch 6: New best validation accuracy: 0.2000
2025-01-23 23:07:48,635 - INFO - Epoch 10: New best validation accuracy: 0.2071
2025-01-23 23:07:48,635 - INFO - Epoch 10
2025-01-23 23:07:48,635 - INFO - Train Loss: 1.8731
2025-01-23 23:07:48,635 - INFO - Val Loss: 1.9180
2025-01-23 23:07:48,636 - INFO - Current Val Accuracy: 0.2071
2025-01-23 23:07:48,636 - INFO - Best Val Accuracy: 0.2071
2025-01-23 23:07:48,829 - INFO - Epoch 15
2025-01-23 23:07:48,830 - INFO - Train Loss: 1.7975
2025-01-23 23:07:48,830 - INFO - Val Loss: 1.9070
2025-01-23 23:07:48,830 - INFO - Current Val Accuracy: 0.1714
2025-01-23 23:07:48,830 - INFO - Best Val Accuracy: 0.2071
2025-01-23 23:07:48,921 - INFO - Epoch 17: New best validation accuracy: 0.2286
2025-01-23 23:07:48,969 - INFO - Epoch 18: New best validation accuracy: 0.2571
2025-01-23 23:07:49,043 - INFO - Epoch 20
2025-01-23 23:07:49,043 - INFO - Train Loss: 1.7396
2025-01-23 23:07:49,043 - INFO - Val Loss: 1.9123
2025-01-23 23:07:49,043 - INFO - Current Val Accuracy: 0.2286
2025-01-23 23:07:49,043 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:07:49,220 - INFO - Epoch 25
2025-01-23 23:07:49,221 - INFO - Train Loss: 1.6312
2025-01-23 23:07:49,221 - INFO - Val Loss: 1.9432
2025-01-23 23:07:49,221 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:07:49,221 - INFO - Best Val Accuracy: 0.2571
2025-01-23 23:07:49,338 - INFO - Epoch 28: New best validation accuracy: 0.2857
2025-01-23 23:07:49,412 - INFO - Epoch 30
2025-01-23 23:07:49,412 - INFO - Train Loss: 1.6085
2025-01-23 23:07:49,412 - INFO - Val Loss: 1.9884
2025-01-23 23:07:49,412 - INFO - Current Val Accuracy: 0.2857
2025-01-23 23:07:49,412 - INFO - Best Val Accuracy: 0.2857
2025-01-23 23:07:49,527 - INFO - Epoch 33: New best validation accuracy: 0.2929
2025-01-23 23:07:49,595 - INFO - Epoch 35
2025-01-23 23:07:49,595 - INFO - Train Loss: 1.5675
2025-01-23 23:07:49,595 - INFO - Val Loss: 2.0518
2025-01-23 23:07:49,595 - INFO - Current Val Accuracy: 0.2286
2025-01-23 23:07:49,595 - INFO - Best Val Accuracy: 0.2929
2025-01-23 23:07:49,784 - INFO - Epoch 40
2025-01-23 23:07:49,784 - INFO - Train Loss: 1.4260
2025-01-23 23:07:49,784 - INFO - Val Loss: 2.0823
2025-01-23 23:07:49,784 - INFO - Current Val Accuracy: 0.2571
2025-01-23 23:07:49,784 - INFO - Best Val Accuracy: 0.2929
2025-01-23 23:07:49,822 - INFO - Epoch 41: New best validation accuracy: 0.4071
2025-01-23 23:07:49,965 - INFO - Epoch 45: New best validation accuracy: 0.4286
2025-01-23 23:07:49,966 - INFO - Epoch 45
2025-01-23 23:07:49,966 - INFO - Train Loss: 1.4781
2025-01-23 23:07:49,966 - INFO - Val Loss: 2.1541
2025-01-23 23:07:49,966 - INFO - Current Val Accuracy: 0.4286
2025-01-23 23:07:49,966 - INFO - Best Val Accuracy: 0.4286
2025-01-23 23:07:50,148 - INFO - Epoch 50: New best validation accuracy: 0.4643
2025-01-23 23:07:50,148 - INFO - Epoch 50
2025-01-23 23:07:50,148 - INFO - Train Loss: 1.4510
2025-01-23 23:07:50,148 - INFO - Val Loss: 2.0685
2025-01-23 23:07:50,148 - INFO - Current Val Accuracy: 0.4643
2025-01-23 23:07:50,148 - INFO - Best Val Accuracy: 0.4643
2025-01-23 23:07:50,325 - INFO - Epoch 55
2025-01-23 23:07:50,326 - INFO - Train Loss: 1.2913
2025-01-23 23:07:50,326 - INFO - Val Loss: 2.1622
2025-01-23 23:07:50,326 - INFO - Current Val Accuracy: 0.3714
2025-01-23 23:07:50,326 - INFO - Best Val Accuracy: 0.4643
2025-01-23 23:07:50,499 - INFO - Early stopping triggered after 60 epochs
2025-01-23 23:07:50,499 - INFO - Best validation accuracy: 0.4643
2025-01-23 23:07:50,499 - INFO - Epoch 60
2025-01-23 23:07:50,499 - INFO - Train Loss: 1.2051
2025-01-23 23:07:50,499 - INFO - Val Loss: 2.1144
2025-01-23 23:07:50,499 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:07:50,499 - INFO - Best Val Accuracy: 0.4643
2025-01-23 23:07:50,536 - INFO - Early stopping triggered after 61 epochs
2025-01-23 23:07:50,536 - INFO - Best validation accuracy: 0.4643
2025-01-23 23:07:50,570 - INFO - Early stopping triggered after 62 epochs
2025-01-23 23:07:50,570 - INFO - Best validation accuracy: 0.4643
2025-01-23 23:07:50,609 - INFO - Epoch 63: New best validation accuracy: 0.4929
2025-01-23 23:07:50,679 - INFO - Epoch 65
2025-01-23 23:07:50,679 - INFO - Train Loss: 1.1784
2025-01-23 23:07:50,679 - INFO - Val Loss: 2.2009
2025-01-23 23:07:50,679 - INFO - Current Val Accuracy: 0.4357
2025-01-23 23:07:50,679 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:54,438 - INFO - Epoch 70
2025-01-23 23:07:54,439 - INFO - Train Loss: 0.9810
2025-01-23 23:07:54,439 - INFO - Val Loss: 2.1962
2025-01-23 23:07:54,439 - INFO - Current Val Accuracy: 0.4357
2025-01-23 23:07:54,439 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:54,543 - INFO - Early stopping triggered after 73 epochs
2025-01-23 23:07:54,543 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,577 - INFO - Early stopping triggered after 74 epochs
2025-01-23 23:07:54,577 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,612 - INFO - Early stopping triggered after 75 epochs
2025-01-23 23:07:54,613 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,613 - INFO - Epoch 75
2025-01-23 23:07:54,613 - INFO - Train Loss: 0.8775
2025-01-23 23:07:54,613 - INFO - Val Loss: 2.4555
2025-01-23 23:07:54,613 - INFO - Current Val Accuracy: 0.4357
2025-01-23 23:07:54,613 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:54,646 - INFO - Early stopping triggered after 76 epochs
2025-01-23 23:07:54,646 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,679 - INFO - Early stopping triggered after 77 epochs
2025-01-23 23:07:54,680 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,714 - INFO - Early stopping triggered after 78 epochs
2025-01-23 23:07:54,714 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,757 - INFO - Early stopping triggered after 79 epochs
2025-01-23 23:07:54,757 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,800 - INFO - Early stopping triggered after 80 epochs
2025-01-23 23:07:54,800 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,800 - INFO - Epoch 80
2025-01-23 23:07:54,800 - INFO - Train Loss: 1.1752
2025-01-23 23:07:54,800 - INFO - Val Loss: 2.4932
2025-01-23 23:07:54,800 - INFO - Current Val Accuracy: 0.3429
2025-01-23 23:07:54,800 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:54,844 - INFO - Early stopping triggered after 81 epochs
2025-01-23 23:07:54,844 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,887 - INFO - Early stopping triggered after 82 epochs
2025-01-23 23:07:54,887 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,934 - INFO - Early stopping triggered after 83 epochs
2025-01-23 23:07:54,934 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:54,968 - INFO - Early stopping triggered after 84 epochs
2025-01-23 23:07:54,968 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,002 - INFO - Early stopping triggered after 85 epochs
2025-01-23 23:07:55,003 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,003 - INFO - Epoch 85
2025-01-23 23:07:55,003 - INFO - Train Loss: 0.8396
2025-01-23 23:07:55,003 - INFO - Val Loss: 2.1470
2025-01-23 23:07:55,003 - INFO - Current Val Accuracy: 0.3786
2025-01-23 23:07:55,003 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:55,037 - INFO - Early stopping triggered after 86 epochs
2025-01-23 23:07:55,037 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,071 - INFO - Early stopping triggered after 87 epochs
2025-01-23 23:07:55,071 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,108 - INFO - Early stopping triggered after 88 epochs
2025-01-23 23:07:55,108 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,142 - INFO - Early stopping triggered after 89 epochs
2025-01-23 23:07:55,142 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,177 - INFO - Early stopping triggered after 90 epochs
2025-01-23 23:07:55,177 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,177 - INFO - Epoch 90
2025-01-23 23:07:55,177 - INFO - Train Loss: 0.7814
2025-01-23 23:07:55,177 - INFO - Val Loss: 2.0925
2025-01-23 23:07:55,177 - INFO - Current Val Accuracy: 0.4357
2025-01-23 23:07:55,177 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:55,212 - INFO - Early stopping triggered after 91 epochs
2025-01-23 23:07:55,213 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,247 - INFO - Early stopping triggered after 92 epochs
2025-01-23 23:07:55,247 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,281 - INFO - Early stopping triggered after 93 epochs
2025-01-23 23:07:55,281 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,317 - INFO - Early stopping triggered after 94 epochs
2025-01-23 23:07:55,317 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,352 - INFO - Early stopping triggered after 95 epochs
2025-01-23 23:07:55,352 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,352 - INFO - Epoch 95
2025-01-23 23:07:55,352 - INFO - Train Loss: 0.6421
2025-01-23 23:07:55,352 - INFO - Val Loss: 2.2806
2025-01-23 23:07:55,352 - INFO - Current Val Accuracy: 0.3786
2025-01-23 23:07:55,352 - INFO - Best Val Accuracy: 0.4929
2025-01-23 23:07:55,386 - INFO - Early stopping triggered after 96 epochs
2025-01-23 23:07:55,386 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,421 - INFO - Early stopping triggered after 97 epochs
2025-01-23 23:07:55,421 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,459 - INFO - Early stopping triggered after 98 epochs
2025-01-23 23:07:55,459 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,492 - INFO - Early stopping triggered after 99 epochs
2025-01-23 23:07:55,493 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,527 - INFO - Early stopping triggered after 100 epochs
2025-01-23 23:07:55,528 - INFO - Best validation accuracy: 0.4929
2025-01-23 23:07:55,528 - INFO - Epoch 100
2025-01-23 23:07:55,528 - INFO - Train Loss: 0.6874
2025-01-23 23:07:55,528 - INFO - Val Loss: 2.2673
2025-01-23 23:07:55,528 - INFO - Current Val Accuracy: 0.4286
2025-01-23 23:07:55,528 - INFO - Best Val Accuracy: 0.4929
