2025-01-27 05:58:17,386 - INFO - Starting training pipeline
2025-01-27 05:58:17,386 - INFO - Starting main training phase
2025-01-27 05:58:17,386 - INFO - Loading dataset: instance-recognition
2025-01-27 05:58:17,386 - INFO - Loading data from: /home/woodj/Desktop/fishy-business/data/REIMS.xlsx
2025-01-27 05:58:23,568 - INFO - Loaded data with shape: (306, 2081)
2025-01-27 05:58:23,572 - INFO - Filtered data shape: (72, 2081)
2025-01-27 05:58:23,572 - INFO - Dataset shape after filtering: (72, 2081)
2025-01-27 05:58:23,573 - INFO - Features shape: (72, 2080), Labels shape: (72, 24)
2025-01-27 05:58:23,737 - INFO - Dataset size increased from 72 to 5112 samples
2025-01-27 05:58:24,107 - INFO - Created model: Transformer(
  (attention_layers): ModuleList(
    (0-3): 4 x MultiHeadAttention(
      (qkv): Linear(in_features=2080, out_features=6240, bias=True)
      (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
    )
  )
  (feed_forward): Sequential(
    (0): Linear(in_features=2080, out_features=128, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=2080, bias=True)
  )
  (layer_norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
  (layer_norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (fc_out): Linear(in_features=2080, out_features=2, bias=True)
)
2025-01-27 05:58:25,503 - INFO - Training model with single train/val split (80/20)
2025-01-27 05:58:25,513 - INFO - Training set size: 3408
2025-01-27 05:58:25,513 - INFO - Validation set size: 1704
2025-01-27 05:58:26,636 - INFO - Epoch 1: New best validation accuracy: 0.4958
2025-01-27 05:58:28,431 - INFO - Epoch 3: New best validation accuracy: 0.4997
2025-01-27 05:58:30,220 - INFO - Epoch 5: New best validation accuracy: 0.5000
2025-01-27 05:58:30,220 - INFO - Epoch 5
2025-01-27 05:58:30,220 - INFO - Train Loss: 0.5192
2025-01-27 05:58:30,220 - INFO - Val Loss: 0.3542
2025-01-27 05:58:30,220 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:30,220 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:34,682 - INFO - Epoch 10
2025-01-27 05:58:34,682 - INFO - Train Loss: 0.2949
2025-01-27 05:58:34,682 - INFO - Val Loss: 0.3068
2025-01-27 05:58:34,682 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:34,682 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:42,736 - INFO - Early stopping triggered after 15 epochs
2025-01-27 05:58:42,736 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:42,736 - INFO - Epoch 15
2025-01-27 05:58:42,736 - INFO - Train Loss: 0.2717
2025-01-27 05:58:42,736 - INFO - Val Loss: 0.2957
2025-01-27 05:58:42,736 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:42,736 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:43,633 - INFO - Early stopping triggered after 16 epochs
2025-01-27 05:58:43,633 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:44,527 - INFO - Early stopping triggered after 17 epochs
2025-01-27 05:58:44,527 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:45,422 - INFO - Early stopping triggered after 18 epochs
2025-01-27 05:58:45,422 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:46,319 - INFO - Early stopping triggered after 19 epochs
2025-01-27 05:58:46,319 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:47,218 - INFO - Early stopping triggered after 20 epochs
2025-01-27 05:58:47,218 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:47,218 - INFO - Epoch 20
2025-01-27 05:58:47,218 - INFO - Train Loss: 0.2668
2025-01-27 05:58:47,218 - INFO - Val Loss: 0.3010
2025-01-27 05:58:47,218 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:47,219 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:48,115 - INFO - Early stopping triggered after 21 epochs
2025-01-27 05:58:48,115 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:49,020 - INFO - Early stopping triggered after 22 epochs
2025-01-27 05:58:49,020 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:49,915 - INFO - Early stopping triggered after 23 epochs
2025-01-27 05:58:49,915 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:50,813 - INFO - Early stopping triggered after 24 epochs
2025-01-27 05:58:50,813 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:51,711 - INFO - Early stopping triggered after 25 epochs
2025-01-27 05:58:51,711 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:51,711 - INFO - Epoch 25
2025-01-27 05:58:51,711 - INFO - Train Loss: 0.2650
2025-01-27 05:58:51,711 - INFO - Val Loss: 0.2999
2025-01-27 05:58:51,711 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:51,711 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:52,606 - INFO - Early stopping triggered after 26 epochs
2025-01-27 05:58:52,606 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:53,502 - INFO - Early stopping triggered after 27 epochs
2025-01-27 05:58:53,503 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:54,399 - INFO - Early stopping triggered after 28 epochs
2025-01-27 05:58:54,399 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:55,296 - INFO - Early stopping triggered after 29 epochs
2025-01-27 05:58:55,296 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:56,193 - INFO - Early stopping triggered after 30 epochs
2025-01-27 05:58:56,193 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:56,193 - INFO - Epoch 30
2025-01-27 05:58:56,193 - INFO - Train Loss: 0.2554
2025-01-27 05:58:56,193 - INFO - Val Loss: 0.2963
2025-01-27 05:58:56,193 - INFO - Current Val Accuracy: 0.5000
2025-01-27 05:58:56,193 - INFO - Best Val Accuracy: 0.5000
2025-01-27 05:58:57,088 - INFO - Early stopping triggered after 31 epochs
2025-01-27 05:58:57,088 - INFO - Best validation accuracy: 0.5000
2025-01-27 05:58:57,986 - INFO - Epoch 32: New best validation accuracy: 0.5101
2025-01-27 05:59:00,669 - INFO - Epoch 35: New best validation accuracy: 0.5205
2025-01-27 05:59:00,669 - INFO - Epoch 35
2025-01-27 05:59:00,669 - INFO - Train Loss: 0.2401
2025-01-27 05:59:00,669 - INFO - Val Loss: 0.2705
2025-01-27 05:59:00,669 - INFO - Current Val Accuracy: 0.5205
2025-01-27 05:59:00,669 - INFO - Best Val Accuracy: 0.5205
2025-01-27 05:59:01,571 - INFO - Epoch 36: New best validation accuracy: 0.5726
2025-01-27 05:59:02,469 - INFO - Epoch 37: New best validation accuracy: 0.5934
2025-01-27 05:59:03,369 - INFO - Epoch 38: New best validation accuracy: 0.6747
2025-01-27 05:59:04,268 - INFO - Epoch 39: New best validation accuracy: 0.6866
2025-01-27 05:59:05,167 - INFO - Epoch 40: New best validation accuracy: 0.6964
2025-01-27 05:59:05,167 - INFO - Epoch 40
2025-01-27 05:59:05,167 - INFO - Train Loss: 0.2329
2025-01-27 05:59:05,167 - INFO - Val Loss: 0.2564
2025-01-27 05:59:05,167 - INFO - Current Val Accuracy: 0.6964
2025-01-27 05:59:05,167 - INFO - Best Val Accuracy: 0.6964
2025-01-27 05:59:06,965 - INFO - Epoch 42: New best validation accuracy: 0.8000
2025-01-27 05:59:09,703 - INFO - Epoch 45
2025-01-27 05:59:09,703 - INFO - Train Loss: 0.2344
2025-01-27 05:59:09,703 - INFO - Val Loss: 0.2545
2025-01-27 05:59:09,703 - INFO - Current Val Accuracy: 0.7074
2025-01-27 05:59:09,703 - INFO - Best Val Accuracy: 0.8000
2025-01-27 05:59:17,900 - INFO - Epoch 49: New best validation accuracy: 0.8095
2025-01-27 05:59:19,074 - INFO - Epoch 50
2025-01-27 05:59:19,074 - INFO - Train Loss: 0.2305
2025-01-27 05:59:19,074 - INFO - Val Loss: 0.2584
2025-01-27 05:59:19,074 - INFO - Current Val Accuracy: 0.7868
2025-01-27 05:59:19,075 - INFO - Best Val Accuracy: 0.8095
2025-01-27 05:59:21,400 - INFO - Epoch 52: New best validation accuracy: 0.8315
2025-01-27 05:59:22,508 - INFO - Epoch 53: New best validation accuracy: 0.8598
2025-01-27 05:59:23,570 - INFO - Epoch 54: New best validation accuracy: 0.8610
2025-01-27 05:59:24,544 - INFO - Epoch 55
2025-01-27 05:59:24,544 - INFO - Train Loss: 0.2104
2025-01-27 05:59:24,544 - INFO - Val Loss: 0.2433
2025-01-27 05:59:24,544 - INFO - Current Val Accuracy: 0.8321
2025-01-27 05:59:24,544 - INFO - Best Val Accuracy: 0.8610
2025-01-27 05:59:25,452 - INFO - Epoch 56: New best validation accuracy: 0.8839
2025-01-27 05:59:26,354 - INFO - Epoch 57: New best validation accuracy: 0.8848
2025-01-27 05:59:29,046 - INFO - Epoch 60
2025-01-27 05:59:29,046 - INFO - Train Loss: 0.2087
2025-01-27 05:59:29,046 - INFO - Val Loss: 0.2326
2025-01-27 05:59:29,047 - INFO - Current Val Accuracy: 0.8438
2025-01-27 05:59:29,047 - INFO - Best Val Accuracy: 0.8848
2025-01-27 05:59:30,845 - INFO - Epoch 62: New best validation accuracy: 0.9062
2025-01-27 05:59:33,524 - INFO - Epoch 65
2025-01-27 05:59:33,524 - INFO - Train Loss: 0.2108
2025-01-27 05:59:33,524 - INFO - Val Loss: 0.2350
2025-01-27 05:59:33,524 - INFO - Current Val Accuracy: 0.8946
2025-01-27 05:59:33,524 - INFO - Best Val Accuracy: 0.9062
2025-01-27 05:59:36,210 - INFO - Epoch 68: New best validation accuracy: 0.9161
2025-01-27 05:59:38,000 - INFO - Epoch 70
2025-01-27 05:59:38,000 - INFO - Train Loss: 0.2184
2025-01-27 05:59:38,000 - INFO - Val Loss: 0.2371
2025-01-27 05:59:38,000 - INFO - Current Val Accuracy: 0.8637
2025-01-27 05:59:38,000 - INFO - Best Val Accuracy: 0.9161
2025-01-27 05:59:42,472 - INFO - Epoch 75
2025-01-27 05:59:42,472 - INFO - Train Loss: 0.2084
2025-01-27 05:59:42,472 - INFO - Val Loss: 0.2329
2025-01-27 05:59:42,472 - INFO - Current Val Accuracy: 0.8839
2025-01-27 05:59:42,472 - INFO - Best Val Accuracy: 0.9161
2025-01-27 05:59:45,158 - INFO - Early stopping triggered after 78 epochs
2025-01-27 05:59:45,158 - INFO - Best validation accuracy: 0.9161
2025-01-27 05:59:46,063 - INFO - Epoch 79: New best validation accuracy: 0.9262
2025-01-27 05:59:46,965 - INFO - Epoch 80
2025-01-27 05:59:46,965 - INFO - Train Loss: 0.2111
2025-01-27 05:59:46,965 - INFO - Val Loss: 0.2269
2025-01-27 05:59:46,965 - INFO - Current Val Accuracy: 0.8952
2025-01-27 05:59:46,965 - INFO - Best Val Accuracy: 0.9262
2025-01-27 05:59:55,024 - INFO - Epoch 85
2025-01-27 05:59:55,024 - INFO - Train Loss: 0.2059
2025-01-27 05:59:55,024 - INFO - Val Loss: 0.2227
2025-01-27 05:59:55,024 - INFO - Current Val Accuracy: 0.9167
2025-01-27 05:59:55,024 - INFO - Best Val Accuracy: 0.9262
2025-01-27 05:59:57,710 - INFO - Epoch 88: New best validation accuracy: 0.9268
2025-01-27 05:59:59,508 - INFO - Epoch 90
2025-01-27 05:59:59,508 - INFO - Train Loss: 0.2117
2025-01-27 05:59:59,508 - INFO - Val Loss: 0.2188
2025-01-27 05:59:59,508 - INFO - Current Val Accuracy: 0.9167
2025-01-27 05:59:59,508 - INFO - Best Val Accuracy: 0.9268
2025-01-27 06:00:03,982 - INFO - Epoch 95
2025-01-27 06:00:03,982 - INFO - Train Loss: 0.2235
2025-01-27 06:00:03,982 - INFO - Val Loss: 0.2261
2025-01-27 06:00:03,982 - INFO - Current Val Accuracy: 0.8533
2025-01-27 06:00:03,982 - INFO - Best Val Accuracy: 0.9268
2025-01-27 06:00:06,675 - INFO - Epoch 98: New best validation accuracy: 0.9577
2025-01-27 06:00:08,466 - INFO - Epoch 100
2025-01-27 06:00:08,466 - INFO - Train Loss: 0.2092
2025-01-27 06:00:08,466 - INFO - Val Loss: 0.2200
2025-01-27 06:00:08,466 - INFO - Current Val Accuracy: 0.9574
2025-01-27 06:00:08,467 - INFO - Best Val Accuracy: 0.9577
