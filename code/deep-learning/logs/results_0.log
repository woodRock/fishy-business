2025-01-10 01:13:46,479 - INFO - Starting training pipeline
2025-01-10 01:13:46,479 - INFO - Starting main training phase
2025-01-10 01:13:46,479 - INFO - Loading dataset: cross-species
2025-01-10 01:13:46,479 - INFO - Loading data from: /home/woodj/Desktop/fishy-business/data/REIMS.xlsx
2025-01-10 01:13:52,552 - INFO - Loaded data with shape: (306, 2081)
2025-01-10 01:13:52,555 - INFO - Filtered data shape: (153, 2081)
2025-01-10 01:13:52,556 - INFO - Dataset shape after filtering: (153, 2081)
2025-01-10 01:13:52,557 - INFO - Features shape: (153, 2080), Labels shape: (153, 3)
2025-01-10 01:13:52,858 - INFO - Created model: TestTimeTransformer(
  (attention_layers): ModuleList(
    (0-3): 4 x MultiHeadAttention(
      (qkv): Linear(in_features=2080, out_features=6240, bias=True)
      (fc_out): Linear(in_features=2080, out_features=2080, bias=True)
    )
  )
  (feed_forward): Sequential(
    (0): Linear(in_features=2080, out_features=128, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=2080, bias=True)
  )
  (layer_norm1): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
  (layer_norm2): LayerNorm((2080,), eps=1e-05, elementwise_affine=True)
  (dropout): Dropout(p=0.2, inplace=False)
  (fc_out): Linear(in_features=2080, out_features=3, bias=True)
  (process_reward_model): SimplifiedPRM(
    (net): Sequential(
      (0): Linear(in_features=3, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (2): ReLU()
      (3): Linear(in_features=128, out_features=128, bias=True)
      (4): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (5): ReLU()
      (6): Linear(in_features=128, out_features=1, bias=True)
      (7): Sigmoid()
    )
  )
  (refinement_network): Sequential(
    (0): Linear(in_features=6, out_features=128, bias=True)
    (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=128, out_features=3, bias=True)
  )
)
2025-01-10 01:13:53,768 - INFO - Starting k-fold cross validation training
2025-01-10 01:13:53,781 - INFO - 
Starting Fold 1/5
2025-01-10 01:13:53,964 - INFO - Epoch 1: New best validation accuracy: 0.5148
2025-01-10 01:13:54,169 - INFO - Epoch 5
2025-01-10 01:13:54,169 - INFO - Train Loss: 26.7748
2025-01-10 01:13:54,169 - INFO - Val Loss: 34.1094
2025-01-10 01:13:54,169 - INFO - Current Val Accuracy: 0.4926
2025-01-10 01:13:54,169 - INFO - Best Val Accuracy: 0.5148
2025-01-10 01:13:54,417 - INFO - Epoch 10: New best validation accuracy: 0.6185
2025-01-10 01:13:54,417 - INFO - Epoch 10
2025-01-10 01:13:54,417 - INFO - Train Loss: 17.8401
2025-01-10 01:13:54,417 - INFO - Val Loss: 12.7693
2025-01-10 01:13:54,417 - INFO - Current Val Accuracy: 0.6185
2025-01-10 01:13:54,417 - INFO - Best Val Accuracy: 0.6185
2025-01-10 01:13:54,468 - INFO - Epoch 11: New best validation accuracy: 0.6426
2025-01-10 01:13:54,661 - INFO - Epoch 15
2025-01-10 01:13:54,661 - INFO - Train Loss: 5.1291
2025-01-10 01:13:54,661 - INFO - Val Loss: 14.6912
2025-01-10 01:13:54,661 - INFO - Current Val Accuracy: 0.5019
2025-01-10 01:13:54,661 - INFO - Best Val Accuracy: 0.6426
2025-01-10 01:13:54,719 - INFO - Epoch 16: New best validation accuracy: 0.7370
2025-01-10 01:13:54,916 - INFO - Epoch 20
2025-01-10 01:13:54,916 - INFO - Train Loss: 5.4561
2025-01-10 01:13:54,916 - INFO - Val Loss: 7.2849
2025-01-10 01:13:54,916 - INFO - Current Val Accuracy: 0.5815
2025-01-10 01:13:54,916 - INFO - Best Val Accuracy: 0.7370
2025-01-10 01:13:54,964 - INFO - Epoch 21: New best validation accuracy: 0.7481
2025-01-10 01:13:55,154 - INFO - Epoch 25
2025-01-10 01:13:55,154 - INFO - Train Loss: 2.7950
2025-01-10 01:13:55,154 - INFO - Val Loss: 5.8351
2025-01-10 01:13:55,154 - INFO - Current Val Accuracy: 0.4852
2025-01-10 01:13:55,154 - INFO - Best Val Accuracy: 0.7481
2025-01-10 01:13:55,393 - INFO - Epoch 30
2025-01-10 01:13:55,393 - INFO - Train Loss: 1.9180
2025-01-10 01:13:55,393 - INFO - Val Loss: 4.5266
2025-01-10 01:13:55,393 - INFO - Current Val Accuracy: 0.5815
2025-01-10 01:13:55,393 - INFO - Best Val Accuracy: 0.7481
2025-01-10 01:13:55,442 - INFO - Early stopping triggered after 31 epochs
2025-01-10 01:13:55,442 - INFO - Best validation accuracy: 0.7481
2025-01-10 01:13:55,492 - INFO - Early stopping triggered after 32 epochs
2025-01-10 01:13:55,492 - INFO - Best validation accuracy: 0.7481
2025-01-10 01:13:55,543 - INFO - Epoch 33: New best validation accuracy: 0.7944
2025-01-10 01:13:55,645 - INFO - Epoch 35
2025-01-10 01:13:55,645 - INFO - Train Loss: 1.5022
2025-01-10 01:13:55,645 - INFO - Val Loss: 2.7018
2025-01-10 01:13:55,645 - INFO - Current Val Accuracy: 0.7000
2025-01-10 01:13:55,645 - INFO - Best Val Accuracy: 0.7944
2025-01-10 01:13:55,883 - INFO - Epoch 40
2025-01-10 01:13:55,883 - INFO - Train Loss: 1.1085
2025-01-10 01:13:55,883 - INFO - Val Loss: 2.4732
2025-01-10 01:13:55,883 - INFO - Current Val Accuracy: 0.7296
2025-01-10 01:13:55,883 - INFO - Best Val Accuracy: 0.7944
2025-01-10 01:13:56,028 - INFO - Early stopping triggered after 43 epochs
2025-01-10 01:13:56,028 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,077 - INFO - Early stopping triggered after 44 epochs
2025-01-10 01:13:56,077 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,123 - INFO - Early stopping triggered after 45 epochs
2025-01-10 01:13:56,123 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,123 - INFO - Epoch 45
2025-01-10 01:13:56,123 - INFO - Train Loss: 0.7767
2025-01-10 01:13:56,123 - INFO - Val Loss: 2.7269
2025-01-10 01:13:56,123 - INFO - Current Val Accuracy: 0.5778
2025-01-10 01:13:56,123 - INFO - Best Val Accuracy: 0.7944
2025-01-10 01:13:56,169 - INFO - Early stopping triggered after 46 epochs
2025-01-10 01:13:56,169 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,218 - INFO - Early stopping triggered after 47 epochs
2025-01-10 01:13:56,218 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,266 - INFO - Early stopping triggered after 48 epochs
2025-01-10 01:13:56,266 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,313 - INFO - Early stopping triggered after 49 epochs
2025-01-10 01:13:56,314 - INFO - Best validation accuracy: 0.7944
2025-01-10 01:13:56,363 - INFO - Epoch 50: New best validation accuracy: 0.8222
2025-01-10 01:13:56,363 - INFO - Epoch 50
2025-01-10 01:13:56,363 - INFO - Train Loss: 0.7979
2025-01-10 01:13:56,363 - INFO - Val Loss: 1.5120
2025-01-10 01:13:56,363 - INFO - Current Val Accuracy: 0.8222
2025-01-10 01:13:56,363 - INFO - Best Val Accuracy: 0.8222
2025-01-10 01:13:56,600 - INFO - Epoch 55
2025-01-10 01:13:56,600 - INFO - Train Loss: 0.6407
2025-01-10 01:13:56,600 - INFO - Val Loss: 1.9579
2025-01-10 01:13:56,600 - INFO - Current Val Accuracy: 0.7944
2025-01-10 01:13:56,600 - INFO - Best Val Accuracy: 0.8222
2025-01-10 01:13:56,839 - INFO - Early stopping triggered after 60 epochs
2025-01-10 01:13:56,839 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:56,839 - INFO - Epoch 60
2025-01-10 01:13:56,839 - INFO - Train Loss: 0.6815
2025-01-10 01:13:56,839 - INFO - Val Loss: 2.0976
2025-01-10 01:13:56,839 - INFO - Current Val Accuracy: 0.5611
2025-01-10 01:13:56,839 - INFO - Best Val Accuracy: 0.8222
2025-01-10 01:13:56,886 - INFO - Early stopping triggered after 61 epochs
2025-01-10 01:13:56,886 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:56,933 - INFO - Early stopping triggered after 62 epochs
2025-01-10 01:13:56,933 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:56,980 - INFO - Early stopping triggered after 63 epochs
2025-01-10 01:13:56,980 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:57,027 - INFO - Early stopping triggered after 64 epochs
2025-01-10 01:13:57,028 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:57,076 - INFO - Early stopping triggered after 65 epochs
2025-01-10 01:13:57,077 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:57,077 - INFO - Epoch 65
2025-01-10 01:13:57,077 - INFO - Train Loss: 1.2850
2025-01-10 01:13:57,077 - INFO - Val Loss: 1.6328
2025-01-10 01:13:57,077 - INFO - Current Val Accuracy: 0.7407
2025-01-10 01:13:57,077 - INFO - Best Val Accuracy: 0.8222
2025-01-10 01:13:57,123 - INFO - Early stopping triggered after 66 epochs
2025-01-10 01:13:57,123 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:57,170 - INFO - Early stopping triggered after 67 epochs
2025-01-10 01:13:57,170 - INFO - Best validation accuracy: 0.8222
2025-01-10 01:13:57,219 - INFO - Epoch 68: New best validation accuracy: 0.8593
2025-01-10 01:13:57,317 - INFO - Epoch 70
2025-01-10 01:13:57,317 - INFO - Train Loss: 1.2577
2025-01-10 01:13:57,317 - INFO - Val Loss: 1.8233
2025-01-10 01:13:57,317 - INFO - Current Val Accuracy: 0.7056
2025-01-10 01:13:57,317 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:57,555 - INFO - Epoch 75
2025-01-10 01:13:57,555 - INFO - Train Loss: 0.8248
2025-01-10 01:13:57,555 - INFO - Val Loss: 2.0409
2025-01-10 01:13:57,556 - INFO - Current Val Accuracy: 0.6333
2025-01-10 01:13:57,556 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:57,701 - INFO - Early stopping triggered after 78 epochs
2025-01-10 01:13:57,701 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,749 - INFO - Early stopping triggered after 79 epochs
2025-01-10 01:13:57,750 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,796 - INFO - Early stopping triggered after 80 epochs
2025-01-10 01:13:57,796 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,796 - INFO - Epoch 80
2025-01-10 01:13:57,796 - INFO - Train Loss: 0.5553
2025-01-10 01:13:57,796 - INFO - Val Loss: 2.2416
2025-01-10 01:13:57,796 - INFO - Current Val Accuracy: 0.4241
2025-01-10 01:13:57,796 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:57,843 - INFO - Early stopping triggered after 81 epochs
2025-01-10 01:13:57,843 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,890 - INFO - Early stopping triggered after 82 epochs
2025-01-10 01:13:57,890 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,937 - INFO - Early stopping triggered after 83 epochs
2025-01-10 01:13:57,937 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:57,988 - INFO - Early stopping triggered after 84 epochs
2025-01-10 01:13:57,988 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,036 - INFO - Early stopping triggered after 85 epochs
2025-01-10 01:13:58,036 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,036 - INFO - Epoch 85
2025-01-10 01:13:58,036 - INFO - Train Loss: 0.5181
2025-01-10 01:13:58,036 - INFO - Val Loss: 1.7006
2025-01-10 01:13:58,036 - INFO - Current Val Accuracy: 0.5463
2025-01-10 01:13:58,036 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:58,084 - INFO - Early stopping triggered after 86 epochs
2025-01-10 01:13:58,084 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,132 - INFO - Early stopping triggered after 87 epochs
2025-01-10 01:13:58,133 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,181 - INFO - Early stopping triggered after 88 epochs
2025-01-10 01:13:58,181 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,229 - INFO - Early stopping triggered after 89 epochs
2025-01-10 01:13:58,229 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,281 - INFO - Early stopping triggered after 90 epochs
2025-01-10 01:13:58,281 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,281 - INFO - Epoch 90
2025-01-10 01:13:58,281 - INFO - Train Loss: 0.4417
2025-01-10 01:13:58,281 - INFO - Val Loss: 1.0966
2025-01-10 01:13:58,281 - INFO - Current Val Accuracy: 0.7444
2025-01-10 01:13:58,281 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:58,331 - INFO - Early stopping triggered after 91 epochs
2025-01-10 01:13:58,332 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,380 - INFO - Early stopping triggered after 92 epochs
2025-01-10 01:13:58,380 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,430 - INFO - Early stopping triggered after 93 epochs
2025-01-10 01:13:58,430 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,479 - INFO - Early stopping triggered after 94 epochs
2025-01-10 01:13:58,479 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,527 - INFO - Early stopping triggered after 95 epochs
2025-01-10 01:13:58,527 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,527 - INFO - Epoch 95
2025-01-10 01:13:58,527 - INFO - Train Loss: 0.4341
2025-01-10 01:13:58,527 - INFO - Val Loss: 0.8416
2025-01-10 01:13:58,527 - INFO - Current Val Accuracy: 0.7204
2025-01-10 01:13:58,527 - INFO - Best Val Accuracy: 0.8593
2025-01-10 01:13:58,576 - INFO - Early stopping triggered after 96 epochs
2025-01-10 01:13:58,576 - INFO - Best validation accuracy: 0.8593
2025-01-10 01:13:58,625 - INFO - Early stopping triggered after 97 epochs
2025-01-10 01:13:58,625 - INFO - Best validation accuracy: 0.8593
